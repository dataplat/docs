<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>dbatools docs | $____COMMANDNAME____$</title>

    <!-- Meta Tags -->
    <meta name="description" content="dbatools PowerShell module command reference for $____COMMANDNAME____$">
    <meta name="keywords" content="dbatools,$____TAGS____$,PowerShell,SQL Server">
    <meta name="author" content="dbatools.io">

    <!-- Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="dbatools docs | $____COMMANDNAME____$">
    <meta property="og:url" content="https://docs.dbatools.io/$____COMMANDNAME____$.html">
    <meta property="og:site_name" content="dbatools.io">
    <meta property="og:image" content="https://docs.dbatools.io/assets/thumbs/$____COMMANDNAME____$.png">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="$____COMMANDNAME____$ - dbatools docs">
    <meta name="twitter:image" content="https://docs.dbatools.io/assets/thumbs/$____COMMANDNAME____$.png">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://docs.dbatools.io/$____COMMANDNAME____$.html">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/tailwind.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css" class="light-theme">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" class="dark-theme" disabled>

    <!-- Favicon -->
    <link rel="icon" href="https://dbatools.io/wp-content/uploads/2016/05/cropped-favicon-192x192.png" sizes="192x192">

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-163558534-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-163558534-1');
    </script>
</head>
<body class="bg-white dark:bg-theme-bg-dark text-theme-text dark:text-theme-text-dark font-sans antialiased">

    <!-- HEADER -->
    <header class="sticky top-0 z-50 bg-white/60 dark:bg-theme-bg-dark/60 backdrop-blur-md border-b-2 border-theme-border/50 dark:border-theme-border-dark/50">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <!-- Logo -->
                <a href="/" class="text-2xl font-bold text-primary dark:text-theme-text-dark hover:opacity-80 transition-opacity">
                    dbatools
                </a>

                <!-- Desktop Navigation -->
                <nav class="hidden md:flex items-center space-x-6">
                    <a href="https://dbatools.io/getting-started" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-theme-text dark:hover:text-theme-text-dark transition-colors">Getting Started</a>
                    <a href="https://dbatools.io/commands" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-theme-text dark:hover:text-theme-text-dark transition-colors">Commands</a>
                    <a href="/" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-theme-text dark:hover:text-theme-text-dark transition-colors">Docs</a>
                    <a href="https://dbatools.io/blog" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-theme-text dark:hover:text-theme-text-dark transition-colors">Blog</a>
                    <a href="https://github.com/dataplat/dbatools" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-theme-text dark:hover:text-theme-text-dark transition-colors" target="_blank">GitHub</a>
                    <a href="https://dbatools.io/book" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-theme-text dark:hover:text-theme-text-dark transition-colors">Book</a>

                    <!-- Theme Toggle -->
                    <button onclick="toggleTheme()" class="p-2 rounded-lg bg-theme-card dark:bg-theme-card-dark border-2 border-theme-border dark:border-theme-border-dark hover:scale-105 transition-transform" aria-label="Toggle dark mode">
                        <svg class="w-5 h-5 hidden dark:block" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"/>
                        </svg>
                        <svg class="w-5 h-5 block dark:hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"/>
                        </svg>
                    </button>
                </nav>

                <!-- Mobile Menu Button -->
                <button onclick="toggleMobileMenu()" class="md:hidden p-2 rounded-lg bg-theme-card dark:bg-theme-card-dark" aria-label="Toggle menu">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                    </svg>
                </button>
            </div>

            <!-- Mobile Menu -->
            <div id="mobile-menu" class="hidden md:hidden mt-4 pb-4 space-y-2">
                <a href="https://dbatools.io/getting-started" class="block py-2 text-theme-text-secondary dark:text-theme-text-secondary-dark">Getting Started</a>
                <a href="https://dbatools.io/commands" class="block py-2 text-theme-text-secondary dark:text-theme-text-secondary-dark">Commands</a>
                <a href="/" class="block py-2 text-theme-text-secondary dark:text-theme-text-secondary-dark">Docs</a>
                <a href="https://dbatools.io/blog" class="block py-2 text-theme-text-secondary dark:text-theme-text-secondary-dark">Blog</a>
                <a href="https://github.com/dataplat/dbatools" class="block py-2 text-theme-text-secondary dark:text-theme-text-secondary-dark">GitHub</a>
                <a href="https://dbatools.io/book" class="block py-2 text-theme-text-secondary dark:text-theme-text-secondary-dark">Book</a>
                <button onclick="toggleTheme()" class="w-full text-left py-2 text-theme-text-secondary dark:text-theme-text-secondary-dark">Toggle Theme</button>
            </div>
        </div>
    </header>

    <!-- MAIN CONTENT -->
    <div class="container-fluid mx-auto px-4 py-8">
        <div class="flex flex-col lg:flex-row gap-8">

            <!-- SIDEBAR -->
            <aside class="lg:w-80 lg:sticky lg:top-24 lg:self-start bg-theme-card dark:bg-theme-card-dark border-2 border-theme-border dark:border-theme-border-dark rounded-xl p-6">
                <div id="relcommands" class="mb-6">
                    <h3 class="text-lg font-semibold mb-2">
                        commands
                        <small id="dbatools_version" class="text-sm font-normal text-theme-text-secondary dark:text-theme-text-secondary-dark"></small>
                    </h3>

                    <!-- Search Box -->
                    <div class="relative mb-4">
                        <input type="text" id="search-ft" class="w-full px-4 py-2 border-2 border-theme-border dark:border-theme-border-dark rounded-lg bg-white dark:bg-theme-bg-dark text-theme-text dark:text-theme-text-dark focus:border-primary focus:outline-none" placeholder="Search commands..." autocomplete="off">
                        <button id="clear-search" class="absolute right-2 top-1/2 transform -translate-y-1/2 text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">&times;</button>
                    </div>

                    <!-- External Links -->
                    <div id="extlist" class="mb-6">
                        <h4 class="text-sm font-semibold mb-2 text-theme-text-secondary dark:text-theme-text-secondary-dark">Quick Links</h4>
                        <ul class="list space-y-1 text-sm">
                            <!-- Populated by JavaScript -->
                        </ul>
                    </div>

                    <!-- Command List -->
                    <div id="cmdlist" class="max-h-96 overflow-y-auto scrollbar-hide">
                        <ul class="list space-y-1 text-sm">
                            <!-- Populated by JavaScript -->
                        </ul>
                    </div>
                </div>
            </aside>

            <!-- MAIN CONTENT AREA -->
            <main class="flex-1 min-w-0">
                <!-- Back to Top Button -->
                <button id="back-to-top" class="back-to-top fixed bottom-8 right-8 p-3 bg-primary text-white rounded-full shadow-lg hover:scale-110 transition-transform">
                    &#94;
                </button>

                <!-- Rendered Command Documentation -->
                <div id="rendered" class="prose prose-lg dark:prose-invert max-w-none">
                    $____RENDERED____$
                </div>
            </main>
        </div>
    </div>

    <!-- FOOTER -->
    <footer class="mt-20 border-t-2 border-theme-border dark:border-theme-border-dark bg-theme-card dark:bg-theme-card-dark">
        <div class="container mx-auto px-6 py-12">
            <div class="grid grid-cols-1 md:grid-cols-5 gap-8">
                <!-- Brand -->
                <div>
                    <h3 class="font-medium text-sm mb-3">dbatools</h3>
                    <p class="text-sm text-theme-text-secondary dark:text-theme-text-secondary-dark">PowerShell module for SQL Server automation</p>
                </div>

                <!-- Project Links -->
                <div>
                    <h3 class="font-medium text-sm mb-3">Project</h3>
                    <ul class="space-y-2 text-sm">
                        <li><a href="https://dbatools.io/getting-started" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Getting Started</a></li>
                        <li><a href="/" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Docs</a></li>
                        <li><a href="https://dbatools.io/commands" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Commands</a></li>
                        <li><a href="https://dbatools.io/download" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Download</a></li>
                    </ul>
                </div>

                <!-- Community -->
                <div>
                    <h3 class="font-medium text-sm mb-3">Community</h3>
                    <ul class="space-y-2 text-sm">
                        <li><a href="https://github.com/dataplat/dbatools" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">GitHub</a></li>
                        <li><a href="https://dbatools.io/slack" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Slack</a></li>
                        <li><a href="https://dbatools.io/contribute" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Contribute</a></li>
                        <li><a href="https://dbatools.io/sponsors" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Sponsors</a></li>
                    </ul>
                </div>

                <!-- Resources -->
                <div>
                    <h3 class="font-medium text-sm mb-3">Resources</h3>
                    <ul class="space-y-2 text-sm">
                        <li><a href="https://dbatools.io/book" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Book</a></li>
                        <li><a href="https://dbatools.io/builds" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Builds</a></li>
                        <li><a href="https://dbatools.io/sponsorship" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Sponsorship</a></li>
                        <li><a href="https://dbatools.io/team" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Team</a></li>
                    </ul>
                </div>

                <!-- About -->
                <div>
                    <h3 class="font-medium text-sm mb-3">About</h3>
                    <ul class="space-y-2 text-sm">
                        <li><a href="https://dbatools.io/license" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">License</a></li>
                        <li><a href="https://dbatools.io/changelog" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Changelog</a></li>
                        <li><a href="https://dbatools.io/contact" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Contact</a></li>
                    </ul>
                </div>
            </div>

            <!-- Copyright -->
            <div class="mt-8 pt-8 border-t border-theme-border dark:border-theme-border-dark text-center text-sm text-theme-text-secondary dark:text-theme-text-secondary-dark">
                &copy; <span id="current-year"></span> dbatools. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- JAVASCRIPT LIBRARIES -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked@11.1.1/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/powershell.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/2.3.1/list.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script>

    <!-- Theme Toggle Script -->
    <script src="/assets/js/theme-toggle.js"></script>

    <!-- EXISTING DOCS JAVASCRIPT -->
    <script>
        // Set current year
        document.getElementById('current-year').textContent = new Date().getFullYear();

        // PowerShell syntax highlighting registration
        function register_dbatools_hljs(dbatoolscommands) {
            hljs.registerLanguage("powershell", function (e) {
                var t = {
                    b: "`[\\s\\S]",
                    r: 0
                },
                o = {
                    cN: "variable",
                    v: [{
                        b: /\$[\w\d][\w\d_:]*/
                    }]
                },
                r = {
                    cN: "literal",
                    b: /\$(null|true|false)\b/
                },
                n = {
                    cN: "string",
                    v: [{
                        b: /"/,
                        e: /"/
                    }, {
                        b: /@"/,
                        e: /^"@/
                    }],
                    c: [t, o, {
                        cN: "variable",
                        b: /\$[A-z]/,
                        e: /[^A-z]/
                    }]
                },
                a = {
                    cN: "string",
                    v: [{
                        b: /'/,
                        e: /'/
                    }, {
                        b: /@'/,
                        e: /^'@/
                    }]
                },
                c = e.inherit(e.C(null, null), {
                    v: [{
                        b: /#/,
                        e: /$/
                    }, {
                        b: /<#/,
                        e: /#>/
                    }],
                    c: [{
                        cN: "doctag",
                        v: [{
                            b: /\.(synopsis|description|example|inputs|outputs|notes|link|component|role|functionality)/
                        }, {
                            b: /\.(parameter|forwardhelptargetname|forwardhelpcategory|remotehelprunspace|externalhelp)\s+\S+/
                        }]
                    }]
                }),
                i = {
                    cN: "built_in",
                    v: [{
                        b: "(".concat(dbatoolscommands, ")")
                    }]
                },
                s = {
                    cN: "class",
                    bK: "class enum",
                    e: /\s*[{]/,
                    eE: !0,
                    r: 0,
                    c: [e.TM]
                },
                l = {
                    cN: "function",
                    b: /function\s+/,
                    e: /\s*\{|$/,
                    eE: !0,
                    rB: !0,
                    r: 0,
                    c: [{
                        b: "function",
                        r: 0,
                        cN: "keyword"
                    }, {
                        cN: "title",
                        b: /\w[\w\d]*((-)[\w\d]+)*/,
                        r: 0
                    }, {
                        b: /\(/,
                        e: /\)/,
                        cN: "params",
                        r: 0,
                        c: [o]
                    }]
                },
                u = {
                    b: /using\s/,
                    e: /$/,
                    rB: !0,
                    c: [n, a, {
                        cN: "keyword",
                        b: /(using|assembly|command|module|namespace|type)/
                    }]
                },
                g = {
                    v: [{
                        cN: "operator",
                        b: "(".concat("-and|-as|-band|-bnot|-bor|-bxor|-casesensitive|-ccontains|-ceq|-cge|-cgt|-cle|-clike|-clt|-cmatch|-cne|-cnotcontains|-cnotlike|-cnotmatch|-contains|-creplace|-csplit|-eq|-exact|-f|-file|-ge|-gt|-icontains|-ieq|-ige|-igt|-ile|-ilike|-ilt|-imatch|-in|-ine|-inotcontains|-inotlike|-inotmatch|-ireplace|-is|-isnot|-isplit|-join|-le|-like|-lt|-match|-ne|-not|-notcontains|-notlike|-notmatch|-or|-regex|-replace|-shl|-shr|-split|-wildcard|-xor)\\b")
                    }, {
                        cN: "literal",
                        b: /(-){1,2}[\w\d-]+/,
                        r: 0
                    }]
                },
                d = {
                    cN: "selector-tag",
                    b: /@\B/,
                    r: 0
                },
                m = {
                    cN: "function",
                    b: /\[.*\]/,
                    eB: !0,
                    eE: !0,
                    e: /$/,
                    r: 0
                },
                p = {
                    b: /\$\(/,
                    e: /\)/,
                    c: [o]
                },
                N = {
                    cN: "keyword",
                    b: /\.(BeginInvoke|EndInvoke|Invoke|ForEach|GetNewClosure|GetType|Dispose)(?=\()/,
                    r: 0
                };
                return {
                    aliases: ["ps"],
                    l: /-?[A-z\.\-]+/,
                    cI: !0,
                    k: {
                        keyword: "if else elseif switch while default for do until break continue foreach return filter in enum begin process end exit inlinescript parallel sequence workflow function param dynamicparam try catch finally throw trap data class",
                        built_in: "Add-Computer Add-Content Add-History Add-JobTrigger Add-Member Add-PSSnapin Add-Type Checkpoint-Computer Clear-Content Clear-EventLog Clear-History Clear-Item Clear-ItemProperty Clear-Variable Compare-Object Complete-Transaction Connect-PSSession Connect-WSMan Convert-Path ConvertFrom-Csv ConvertFrom-Json ConvertFrom-SecureString ConvertFrom-StringData ConvertTo-Csv ConvertTo-Html ConvertTo-Json ConvertTo-SecureString ConvertTo-Xml Copy-Item Copy-ItemProperty Debug-Job Debug-Process Debug-Runspace Disable-ComputerRestore Disable-JobTrigger Disable-PSBreakpoint Disable-PSRemoting Disable-PSSessionConfiguration Disable-RunspaceDebug Disable-ScheduledJob Disable-WSManCredSSP Disconnect-PSSession Disconnect-WSMan Enable-ComputerRestore Enable-JobTrigger Enable-PSBreakpoint Enable-PSRemoting Enable-PSSessionConfiguration Enable-RunspaceDebug Enable-ScheduledJob Enable-WSManCredSSP Enter-PSHostProcess Enter-PSSession Exit-PSHostProcess Exit-PSSession Export-Alias Export-Clixml Export-Console Export-Counter Export-Csv Export-FormatData Export-ModuleMember Export-PSSession ForEach-Object Format-Custom Format-List Format-Table Format-Wide Get-Acl Get-Alias Get-AuthenticodeSignature Get-ChildItem Get-CimAssociatedInstance Get-CimClass Get-CimInstance Get-CimSession Get-Clipboard Get-CmsMessage Get-Command Get-ComputerInfo Get-ComputerRestorePoint Get-Content Get-ControlPanelItem Get-Counter Get-Credential Get-Culture Get-Date Get-DscConfiguration Get-DscConfigurationStatus Get-DscLocalConfigurationManager Get-DscResource Get-Event Get-EventLog Get-EventSubscriber Get-ExecutionPolicy Get-ExperimentalFeature Get-FileHash Get-FormatData Get-Help Get-History Get-Host Get-HotFix Get-Item Get-ItemProperty Get-ItemPropertyValue Get-Job Get-JobTrigger Get-Location Get-Member Get-Module Get-Package Get-PackageProvider Get-PackageSource Get-PfxCertificate Get-Process Get-PSBreakpoint Get-PSCallStack Get-PSDrive Get-PSHostProcessInfo Get-PSProvider Get-PSReadlineKeyHandler Get-PSReadlineOption Get-PSRepository Get-PSSession Get-PSSessionCapability Get-PSSessionConfiguration Get-PSSnapin Get-Random Get-Runspace Get-RunspaceDebug Get-ScheduledJob Get-ScheduledJobOption Get-Service Get-TimeZone Get-TraceSource Get-Transaction Get-TroubleshootingPack Get-TypeData Get-UICulture Get-Unique Get-Variable Get-Verb Get-WinEvent Get-WmiObject Get-WSManCredSSP Get-WSManInstance Group-Object Import-Alias Import-BinaryModule Import-Clixml Import-Counter Import-Csv Import-LocalizedData Import-Module Import-PackageProvider Import-PowerShellDataFile Import-PSSession Invoke-CimMethod Invoke-Command Invoke-CommandInDesktopPackage Invoke-DscResource Invoke-Expression Invoke-History Invoke-Item Invoke-RestMethod Invoke-TroubleshootingPack Invoke-WebRequest Invoke-WmiMethod Invoke-WSManAction Join-Path Limit-EventLog Measure-Command Measure-Object Move-Item Move-ItemProperty New-Alias New-CimInstance New-CimSession New-CimSessionOption New-Event New-EventLog New-FileCatalog New-Guid New-Item New-ItemProperty New-JobTrigger New-LocalGroup New-LocalUser New-Module New-ModuleManifest New-Object New-PSDrive New-PSRoleCapabilityFile New-PSSession New-PSSessionConfigurationFile New-PSSessionOption New-PSTransportOption New-PSWorkflowExecutionOption New-PSWorkflowSession New-ScheduledJobOption New-Service New-TemporaryFile New-TimeSpan New-Variable New-WebServiceProxy New-WinEvent New-WSManInstance New-WSManSessionOption Out-Default Out-File Out-GridView Out-Host Out-Null Out-Printer Out-String Pop-Location Protect-CmsMessage Publish-DscConfiguration Publish-Module Publish-PSResource Push-Location Read-Host Receive-Job Receive-PSSession Register-ArgumentCompleter Register-CimIndicationEvent Register-EngineEvent Register-ObjectEvent Register-PackageSource Register-PSRepository Register-PSSessionConfiguration Register-ScheduledJob Register-WmiEvent Remove-CimInstance Remove-CimSession Remove-Computer Remove-Event Remove-EventLog Remove-Item Remove-ItemProperty Remove-Job Remove-JobTrigger Remove-LocalGroup Remove-LocalGroupMember Remove-LocalUser Remove-Module Remove-PSBreakpoint Remove-PSDrive Remove-PSReadlineKeyHandler Remove-PSSession Remove-PSSnapin Remove-TypeData Remove-Variable Remove-WmiObject Remove-WSManInstance Rename-Computer Rename-Item Rename-ItemProperty Rename-LocalGroup Rename-LocalUser Reset-ComputerMachinePassword Resolve-DnsName Resolve-Path Restart-Computer Restart-Service Restore-Computer Resume-Job Resume-Service Save-Help Save-Module Save-Package Select-Object Select-String Select-Xml Send-MailMessage Set-Acl Set-Alias Set-AuthenticodeSignature Set-CimInstance Set-Clipboard Set-Content Set-Date Set-DscLocalConfigurationManager Set-ExecutionPolicy Set-Item Set-ItemProperty Set-JobTrigger Set-LocalGroup Set-LocalUser Set-Location Set-PSBreakpoint Set-PSDebug Set-PSReadlineKeyHandler Set-PSReadlineOption Set-PSRepository Set-PSSessionConfiguration Set-ScheduledJob Set-ScheduledJobOption Set-Service Set-StrictMode Set-TimeZone Set-TraceSource Set-Variable Set-WmiInstance Set-WSManInstance Set-WSManQuickConfig Show-Command Show-ControlPanelItem Show-EventLog Sort-Object Split-Path Start-DscConfiguration Start-Job Start-Process Start-Service Start-Sleep Start-Transaction Start-Transcript Stop-Computer Stop-Job Stop-Process Stop-Service Stop-Transcript Suspend-Job Suspend-Service Switch-Certificate Tee-Object Test-Connection Test-DscConfiguration Test-FileCatalog Test-ModuleManifest Test-Path Test-PSSessionConfigurationFile Test-WSMan Trace-Command Unblock-File Undo-Transaction Uninstall-Module Uninstall-Package Unprotect-CmsMessage Unregister-Event Unregister-PackageSource Unregister-PSRepository Unregister-PSSessionConfiguration Unregister-ScheduledJob Update-FormatData Update-Help Update-List Update-Module Update-ModuleManifest Update-TypeData Update-WmiInstance Use-Transaction Wait-Debugger Wait-Event Wait-Job Wait-Process Where-Object Write-Debug Write-Error Write-EventLog Write-Host Write-Information Write-Output Write-Progress Write-Verbose Write-Warning " + dbatoolscommands,
                        nomarkup: "-ne -eq -lt -gt -ge -le -not -like -notlike -match -notmatch -contains -notcontains -in -notin -replace"
                    },
                    c: [t, r, n, a, m, c, o, d, N, l, g, i, s, u, p]
                }
            });
        }

        // Document ready
        $(document).ready(function() {
            // Render documentation
            function render_doc() {
                $('#rendered').find('pre>code').each(function () {
                    $(this).addClass('wrapped')
                    hljs.highlightBlock(this);
                });

                var clipboard = new ClipboardJS('.copy');
                clipboard.on('success', function (e) {
                    e.clearSelection();
                    var btnText = $(e.trigger).text();
                    $(e.trigger).text('Copied');
                    setTimeout(function () {
                        $(e.trigger).text(btnText);
                    }, 1500);
                });
            }

            // Load index and external data
            var external_url = '/assets/external.json';
            var idx_url = '/assets/dbatools-index.json';

            var options = {
                valueNames: ['CommandName', 'Alias', 'Tags', 'Description', 'Synopsis', 'Examples', 'Params'],
                item: '<div><a class="list-group-item list-group-item-secondary CommandName" href="#"><span class="CommandName"></span></a></div>'
            };

            var cmdlist = new List('cmdlist', options, []);

            $.getJSON(idx_url, function (data) {
                cmdlist.add(data);
                var dbacommands = [];
                var cloudlist = {};
                _.forEach(data, function (el) {
                    dbacommands.push(el.CommandName);
                    if (_.isArray(el.Tags)) {
                        _.forEach(el.Tags, function (el) {
                            if (!_.has(cloudlist, el)) {
                                cloudlist[el] = 0;
                            }
                            cloudlist[el] += 1;
                        });
                    } else if (!_.isUndefined(el.Tags)) {
                        if (!_.has(cloudlist, el.Tags)) {
                            cloudlist[el.Tags] = 0;
                        }
                        cloudlist[el.Tags] += 1;
                    }
                });

                register_dbatools_hljs(dbacommands.join(' '));
                $(window).trigger('hashchange');
            });

            var options2 = {
                valueNames: ['extName', { name: 'extHref', attr: 'href' }],
                item: '<div><a class="list-group-item list-group-item-secondary extHref" href="#" target="_blank"><span class="extName"></span></a></div>'
            };
            extlist = new List('extlist', options2, []);

            $.getJSON(external_url, function (data) {
                $('#dbatools_version').text('(v ' + data.version + ')');
                _.forEach(data.external_links, function (el) {
                    extlist.add({ 'extName': el.name, 'extHref': el.href });
                });
            });

            cmdlist.on('searchComplete', function (e) {
                if (cmdlist.matchingItems.length === 0) {
                    var searchString = $('#search-ft').val().trim();
                    if (searchString.length > 0 && !searchString.startsWith("ft:")) {
                        if (searchString != "f" && searchString != "ft" && searchString != "ft:") {
                            $('#search-ft').val("ft:" + searchString);
                        }
                    }
                }
            });

            $(document).on('mouseenter', '#cmdlist', function (e) {
                $('#search-ft').blur();
            });

            cmdlist.on('updated', function() {
                $('#cmdlist a').each(function(i, el) {
                    $(el).attr('href', $(el).find('span.CommandName').text());
                });
            });

            $('#cmdlist').on('mouseenter', 'a', function (e) {
                $(this).attr('href', $(this).find('span.CommandName').text());
            });

            $('#search-ft').bind('change keyup', function () {
                var searchString = $(this).val();
                if (searchString.trim() == "ft:" || searchString.trim() == "tag:") {
                    extlist.search();
                }
                else if (searchString.startsWith("ft:")) {
                    searchString = searchString.substring(3).trim();
                    if (cmdlist.filtered) {
                        cmdlist.filter();
                    }
                    cmdlist.search(searchString, ['CommandName', 'Alias', 'Description', 'Synopsis', 'Examples', 'Params']);
                } else if (searchString.startsWith("tag:")) {
                    searchString = searchString.substring(4).trim();
                    if (cmdlist.searched) {
                        cmdlist.search();
                    }
                    cmdlist.filter(function (item) {
                        if (_.indexOf(item.values().Tags, searchString) !== -1) {
                            return true;
                        } else {
                            return false;
                        }
                    });
                } else {
                    if (cmdlist.filtered) {
                        cmdlist.filter();
                    }
                    cmdlist.search(searchString);
                    extlist.search(searchString);
                }
            });

            $('#clear-search').click(function () {
                $('#search-ft').val('').trigger('change');
                cmdlist.search();
                extlist.search();
                if (cmdlist.filtered) {
                    cmdlist.filter();
                }
            });

            // Back to top button
            $(window).scroll(function() {
                if ($(this).scrollTop() > 200) {
                    $('#back-to-top').fadeIn();
                } else {
                    $('#back-to-top').fadeOut();
                }
            });

            $('#back-to-top').click(function() {
                $('html, body').animate({scrollTop: 0}, 600);
                return false;
            });

            // Update highlight.js theme based on dark mode
            function updateHighlightTheme() {
                const isDark = document.documentElement.classList.contains('dark');
                document.querySelector('.light-theme').disabled = isDark;
                document.querySelector('.dark-theme').disabled = !isDark;
            }

            // Watch for theme changes
            const observer = new MutationObserver(updateHighlightTheme);
            observer.observe(document.documentElement, {
                attributes: true,
                attributeFilter: ['class']
            });
            updateHighlightTheme();

            // Render the documentation
            render_doc();
        });
    </script>
</body>
</html>
