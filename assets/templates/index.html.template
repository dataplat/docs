<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>dbatools docs</title>

    <!-- Meta Tags -->
    <meta name="description" content="dbatools PowerShell module command reference and documentation">
    <meta name="keywords" content="dbatools,PowerShell,SQL Server,documentation">
    <meta name="author" content="dbatools.io">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="dbatools docs">
    <meta property="og:url" content="https://docs.dbatools.io/">
    <meta property="og:site_name" content="dbatools.io">
    <meta property="og:image" content="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="dbatools docs">
    <meta name="twitter:image" content="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://docs.dbatools.io/">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/tailwind.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css" class="light-theme">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" class="dark-theme" disabled>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqcloud/2.0.3/jqcloud.min.css">

    <!-- Favicon -->
    <link rel="icon" href="https://dbatools.io/wp-content/uploads/2016/05/cropped-favicon-192x192.png" sizes="192x192">

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-163558534-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-163558534-1');
    </script>
</head>
<body class="bg-white dark:bg-theme-bg-dark text-theme-text dark:text-theme-text-dark font-sans antialiased">

    <!-- HEADER -->
    <header class="sticky top-0 z-50 bg-white/60 dark:bg-theme-bg-dark/60 backdrop-blur-md border-b-2 border-theme-border/50 dark:border-theme-border-dark/50">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <!-- Logo -->
                <a href="/" class="text-2xl font-bold text-primary dark:text-theme-text-dark hover:opacity-80 transition-opacity">
                    dbatools
                </a>

                <!-- Desktop Navigation -->
                <nav class="hidden md:flex items-center space-x-6">
                    <a href="https://dbatools.io/getting-started" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-theme-text dark:hover:text-theme-text-dark transition-colors">Getting Started</a>
                    <a href="https://dbatools.io/commands" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-theme-text dark:hover:text-theme-text-dark transition-colors">Commands</a>
                    <a href="/" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-theme-text dark:hover:text-theme-text-dark transition-colors">Docs</a>
                    <a href="https://dbatools.io/blog" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-theme-text dark:hover:text-theme-text-dark transition-colors">Blog</a>
                    <a href="https://github.com/dataplat/dbatools" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-theme-text dark:hover:text-theme-text-dark transition-colors" target="_blank">GitHub</a>
                    <a href="https://dbatools.io/book" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-theme-text dark:hover:text-theme-text-dark transition-colors">Book</a>

                    <!-- Theme Toggle -->
                    <button onclick="toggleTheme()" class="p-2 rounded-lg bg-theme-card dark:bg-theme-card-dark border-2 border-theme-border dark:border-theme-border-dark hover:scale-105 transition-transform" aria-label="Toggle dark mode">
                        <svg class="w-5 h-5 hidden dark:block" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"/>
                        </svg>
                        <svg class="w-5 h-5 block dark:hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"/>
                        </svg>
                    </button>
                </nav>

                <!-- Mobile Menu Button -->
                <button onclick="toggleMobileMenu()" class="md:hidden p-2 rounded-lg bg-theme-card dark:bg-theme-card-dark" aria-label="Toggle menu">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                    </svg>
                </button>
            </div>

            <!-- Mobile Menu -->
            <div id="mobile-menu" class="hidden md:hidden mt-4 pb-4 space-y-2">
                <a href="https://dbatools.io/getting-started" class="block py-2 text-theme-text-secondary dark:text-theme-text-secondary-dark">Getting Started</a>
                <a href="https://dbatools.io/commands" class="block py-2 text-theme-text-secondary dark:text-theme-text-secondary-dark">Commands</a>
                <a href="/" class="block py-2 text-theme-text-secondary dark:text-theme-text-secondary-dark">Docs</a>
                <a href="https://dbatools.io/blog" class="block py-2 text-theme-text-secondary dark:text-theme-text-secondary-dark">Blog</a>
                <a href="https://github.com/dataplat/dbatools" class="block py-2 text-theme-text-secondary dark:text-theme-text-secondary-dark">GitHub</a>
                <a href="https://dbatools.io/book" class="block py-2 text-theme-text-secondary dark:text-theme-text-secondary-dark">Book</a>
                <button onclick="toggleTheme()" class="w-full text-left py-2 text-theme-text-secondary dark:text-theme-text-secondary-dark">Toggle Theme</button>
            </div>
        </div>
    </header>

    <!-- MAIN CONTENT -->
    <div class="container mx-auto px-4 py-12">
        <!-- Welcome Section -->
        <div class="max-w-4xl mx-auto text-center mb-12">
            <h1 class="text-4xl font-bold mb-4">dbatools Command Reference</h1>
            <p class="text-lg text-theme-text-secondary dark:text-theme-text-secondary-dark">
                Search and explore all PowerShell commands in the dbatools module
            </p>
        </div>

        <div class="flex flex-col lg:flex-row gap-8">
            <!-- SIDEBAR -->
            <aside class="lg:w-80 lg:sticky lg:top-24 lg:self-start bg-theme-card dark:bg-theme-card-dark border-2 border-theme-border dark:border-theme-border-dark rounded-xl p-6">
                <div id="relcommands" class="mb-6">
                    <h3 class="text-lg font-semibold mb-2">
                        commands
                        <small id="dbatools_version" class="text-sm font-normal text-theme-text-secondary dark:text-theme-text-secondary-dark"></small>
                    </h3>

                    <!-- Search Box -->
                    <div class="relative mb-4">
                        <input type="text" id="search-ft" class="w-full px-4 py-2 border-2 border-theme-border dark:border-theme-border-dark rounded-lg bg-white dark:bg-theme-bg-dark text-theme-text dark:text-theme-text-dark focus:border-primary focus:outline-none" placeholder="Search commands..." autocomplete="off">
                        <button id="clear-search" class="absolute right-2 top-1/2 transform -translate-y-1/2 text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">&times;</button>
                    </div>

                    <!-- External Links -->
                    <div id="extlist" class="mb-6">
                        <h4 class="text-sm font-semibold mb-2 text-theme-text-secondary dark:text-theme-text-secondary-dark">Quick Links</h4>
                        <ul class="list space-y-1 text-sm">
                            <!-- Populated by JavaScript -->
                        </ul>
                    </div>

                    <!-- Command List -->
                    <div id="cmdlist" class="max-h-96 overflow-y-auto scrollbar-hide">
                        <ul class="list space-y-1 text-sm">
                            <!-- Populated by JavaScript -->
                        </ul>
                    </div>
                </div>
            </aside>

            <!-- MAIN CONTENT AREA -->
            <main class="flex-1 min-w-0">
                <div class="prose prose-lg dark:prose-invert max-w-none">
                    <div id="rendered">
                        <h2>Welcome to dbatools documentation</h2>
                        <p>Use the search on the left to find commands, or click on any tag in the cloud below to filter commands by category.</p>

                        <!-- Tag Cloud Canvas -->
                        <div id="canvas" class="my-8" style="height: 400px;"></div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- FOOTER -->
    <footer class="mt-20 border-t-2 border-theme-border dark:border-theme-border-dark bg-theme-card dark:bg-theme-card-dark">
        <div class="container mx-auto px-6 py-12">
            <div class="grid grid-cols-1 md:grid-cols-5 gap-8">
                <!-- Brand -->
                <div>
                    <h3 class="font-medium text-sm mb-3">dbatools</h3>
                    <p class="text-sm text-theme-text-secondary dark:text-theme-text-secondary-dark">PowerShell module for SQL Server automation</p>
                </div>

                <!-- Project Links -->
                <div>
                    <h3 class="font-medium text-sm mb-3">Project</h3>
                    <ul class="space-y-2 text-sm">
                        <li><a href="https://dbatools.io/getting-started" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Getting Started</a></li>
                        <li><a href="/" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Docs</a></li>
                        <li><a href="https://dbatools.io/commands" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Commands</a></li>
                        <li><a href="https://dbatools.io/download" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Download</a></li>
                    </ul>
                </div>

                <!-- Community -->
                <div>
                    <h3 class="font-medium text-sm mb-3">Community</h3>
                    <ul class="space-y-2 text-sm">
                        <li><a href="https://github.com/dataplat/dbatools" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">GitHub</a></li>
                        <li><a href="https://dbatools.io/slack" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Slack</a></li>
                        <li><a href="https://dbatools.io/contribute" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Contribute</a></li>
                        <li><a href="https://dbatools.io/sponsors" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Sponsors</a></li>
                    </ul>
                </div>

                <!-- Resources -->
                <div>
                    <h3 class="font-medium text-sm mb-3">Resources</h3>
                    <ul class="space-y-2 text-sm">
                        <li><a href="https://dbatools.io/book" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Book</a></li>
                        <li><a href="https://dbatools.io/builds" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Builds</a></li>
                        <li><a href="https://dbatools.io/sponsorship" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Sponsorship</a></li>
                        <li><a href="https://dbatools.io/team" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Team</a></li>
                    </ul>
                </div>

                <!-- About -->
                <div>
                    <h3 class="font-medium text-sm mb-3">About</h3>
                    <ul class="space-y-2 text-sm">
                        <li><a href="https://dbatools.io/license" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">License</a></li>
                        <li><a href="https://dbatools.io/changelog" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Changelog</a></li>
                        <li><a href="https://dbatools.io/contact" class="text-theme-text-secondary dark:text-theme-text-secondary-dark hover:text-primary transition-colors">Contact</a></li>
                    </ul>
                </div>
            </div>

            <!-- Copyright -->
            <div class="mt-8 pt-8 border-t border-theme-border dark:border-theme-border-dark text-center text-sm text-theme-text-secondary dark:text-theme-text-secondary-dark">
                &copy; <span id="current-year"></span> dbatools. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- JAVASCRIPT LIBRARIES -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/powershell.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/2.3.1/list.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqcloud/2.0.3/jqcloud.min.js"></script>

    <!-- Theme Toggle Script -->
    <script src="/assets/js/theme-toggle.js"></script>

    <!-- DOCS JAVASCRIPT -->
    <script>
        // Set current year
        document.getElementById('current-year').textContent = new Date().getFullYear();

        // Document ready
        $(document).ready(function() {
            // Load index and external data
            var external_url = '/assets/external.json';
            var idx_url = '/assets/dbatools-index.json';

            var options = {
                valueNames: ['CommandName', 'Alias', 'Tags', 'Description', 'Synopsis', 'Examples', 'Params'],
                item: '<div><a class="list-group-item list-group-item-secondary CommandName" href="#"><span class="CommandName"></span></a></div>'
            };

            var cmdlist = new List('cmdlist', options, []);

            $.getJSON(idx_url, function (data) {
                cmdlist.add(data);
                var cloudlist = {};

                _.forEach(data, function (el) {
                    if (_.isArray(el.Tags)) {
                        _.forEach(el.Tags, function (tag) {
                            if (!_.has(cloudlist, tag)) {
                                cloudlist[tag] = 0;
                            }
                            cloudlist[tag] += 1;
                        });
                    } else if (!_.isUndefined(el.Tags)) {
                        if (!_.has(cloudlist, el.Tags)) {
                            cloudlist[el.Tags] = 0;
                        }
                        cloudlist[el.Tags] += 1;
                    }
                });

                // Create tag cloud
                var weightedVals = [];
                _.forEach(cloudlist, function (value, key) {
                    weightedVals.push({
                        text: key,
                        weight: value,
                        handlers: {
                            click: function () {
                                $('#search-ft').val('tag:' + key).trigger('keyup');
                            }
                        }
                    });
                });

                var pixelHeight = window.innerHeight * 0.65;
                $('#canvas').css({ 'height': pixelHeight + 'px' });
                $('#canvas').jQCloud(weightedVals, {
                    autoResize: true
                });
            });

            var options2 = {
                valueNames: ['extName', { name: 'extHref', attr: 'href' }],
                item: '<div><a class="list-group-item list-group-item-secondary extHref" href="#" target="_blank"><span class="extName"></span></a></div>'
            };
            extlist = new List('extlist', options2, []);

            $.getJSON(external_url, function (data) {
                $('#dbatools_version').text('(v ' + data.version + ')');
                _.forEach(data.external_links, function (el) {
                    extlist.add({ 'extName': el.name, 'extHref': el.href });
                });
            });

            cmdlist.on('searchComplete', function (e) {
                if (cmdlist.matchingItems.length === 0) {
                    var searchString = $('#search-ft').val().trim();
                    if (searchString.length > 0 && !searchString.startsWith("ft:")) {
                        if (searchString != "f" && searchString != "ft" && searchString != "ft:") {
                            $('#search-ft').val("ft:" + searchString);
                        }
                    }
                }
            });

            $(document).on('mouseenter', '#cmdlist', function (e) {
                $('#search-ft').blur();
            });

            cmdlist.on('updated', function() {
                $('#cmdlist a').each(function(i, el) {
                    $(el).attr('href', $(el).find('span.CommandName').text());
                });
            });

            $('#cmdlist').on('mouseenter', 'a', function (e) {
                $(this).attr('href', $(this).find('span.CommandName').text());
            });

            $('#search-ft').bind('change keyup', function () {
                var searchString = $(this).val();
                if (searchString.trim() == "ft:" || searchString.trim() == "tag:") {
                    extlist.search();
                }
                else if (searchString.startsWith("ft:")) {
                    searchString = searchString.substring(3).trim();
                    if (cmdlist.filtered) {
                        cmdlist.filter();
                    }
                    cmdlist.search(searchString, ['CommandName', 'Alias', 'Description', 'Synopsis', 'Examples', 'Params']);
                } else if (searchString.startsWith("tag:")) {
                    searchString = searchString.substring(4).trim();
                    if (cmdlist.searched) {
                        cmdlist.search();
                    }
                    cmdlist.filter(function (item) {
                        if (_.indexOf(item.values().Tags, searchString) !== -1) {
                            return true;
                        } else {
                            return false;
                        }
                    });
                } else {
                    if (cmdlist.filtered) {
                        cmdlist.filter();
                    }
                    cmdlist.search(searchString);
                    extlist.search(searchString);
                }
            });

            $('#clear-search').click(function () {
                $('#search-ft').val('').trigger('change');
                cmdlist.search();
                extlist.search();
                if (cmdlist.filtered) {
                    cmdlist.filter();
                }
            });

            // Update highlight.js theme based on dark mode
            function updateHighlightTheme() {
                const isDark = document.documentElement.classList.contains('dark');
                const lightTheme = document.querySelector('.light-theme');
                const darkTheme = document.querySelector('.dark-theme');
                if (lightTheme) lightTheme.disabled = isDark;
                if (darkTheme) darkTheme.disabled = !isDark;
            }

            // Watch for theme changes
            const observer = new MutationObserver(updateHighlightTheme);
            observer.observe(document.documentElement, {
                attributes: true,
                attributeFilter: ['class']
            });
            updateHighlightTheme();
        });
    </script>
</body>
</html>
