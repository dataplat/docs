<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>dbatools docs | Connect-DbaInstance</title>
    <link rel="icon" href="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png" sizes="32x32">
    <link rel="icon" href="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png" sizes="192x192">
    <link rel="apple-touch-icon-precomposed" href="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png">
    <meta name="msapplication-TileImage" content="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png">

    <link title="Search" rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml">
    <meta name="keywords" content="dbatools, ,powershell,sql server,devops,json">
    <meta name="subtitle" content="Docs for Connect-DbaInstance">
    <meta property="og:type" content="article" />
    <meta property="og:title" content="dbatools docs:  Connect-DbaInstance" />
    <meta property="og:url" content="https://docs.dbatools.io/Connect-DbaInstance.html" />
    <meta property="og:description" content="dbatools docs for Connect-DbaInstance" />
    <meta property="og:site_name" content="docs.dbatools.io" />
    <meta property="og:locale" content="en_US" />
    <meta name="twitter:text:title" content="dbatools docs:  Connect-DbaInstance" />
    
    <meta name="twitter:image" content="https://docs.dbatools.io/assets/thumbs/Connect-DbaInstance.png">
    <meta name="twitter:card" content="summary_large_image">
    
    <meta name=twitter:creator content="@psdbatools">
    <meta name=twitter:title content="dbatools docs:  Connect-DbaInstance">
    <meta property="twitter:site" content="@psdbatools" />

    <meta property="og:image" content="https://docs.dbatools.io/assets/thumbs/Connect-DbaInstance.png">
    <link rel=canonical href="https://docs.dbatools.io/Connect-DbaInstance.html" />
    <link rel=alternate type=application/json
        href=https://raw.githubusercontent.com/dataplat/dbatools/master/bin/dbatools-index.json
        title="dbatools documentation">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css"
        href="//cdnjs.cloudflare.com/ajax/libs/open-iconic/1.1.1/font/css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" type="text/css"
        href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

    <link rel="stylesheet" href="assets/css/layout.css">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-80639740-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-80639740-2');
    </script>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
    <script src="//cdn.jsdelivr.net/npm/lodash@4.17.4/lodash.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="//cdn.jsdelivr.net/jquery.scrollto/2.1.2/jquery.scrollTo.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/autolinker/1.7.1/Autolinker.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jqcloud2@2.0.3/dist/jqcloud.min.js"
        integrity="sha256-+krhsKJpvd3AZYVGHcwyCUGO01uNdGSTvqR7Apcy30E=" crossorigin="anonymous"></script>

    <script type="text/javascript" language="javascript">
        function register_dbatools_hljs(dbatoolscommands) {

            hljs.registerLanguage("powershell", function (e) {
                var t = {
                    b: "`[\\s\\S]",
                    r: 0
                },
                    o = {
                        cN: "variable",
                        v: [{
                            b: /\$[\w\d][\w\d_:]*/
                        }]
                    },
                    r = {
                        cN: "literal",
                        b: /\$(null|true|false)\b/
                    },
                    n = {
                        cN: "string",
                        v: [{
                            b: /"/,
                            e: /"/
                        }, {
                            b: /@"/,
                            e: /^"@/
                        }],
                        c: [t, o, {
                            cN: "variable",
                            b: /\$[A-z]/,
                            e: /[^A-z]/
                        }]
                    },
                    a = {
                        cN: "string",
                        v: [{
                            b: /'/,
                            e: /'/
                        }, {
                            b: /@'/,
                            e: /^'@/
                        }]
                    },
                    i = {
                        cN: "doctag",
                        v: [{
                            b: /\.(synopsis|description|example|inputs|outputs|notes|link|component|role|functionality)/
                        }, {
                            b: /\.(parameter|forwardhelptargetname|forwardhelpcategory|remotehelprunspace|externalhelp)\s+\S+/
                        }]
                    },
                    s = e.inherit(e.C(null, null), {
                        v: [{
                            b: /#/,
                            e: /$/
                        }, {
                            b: /<#/,
                            e: /#>/
                        }],
                        c: [i]
                    });
                return {
                    aliases: ["ps"],
                    l: /-?[A-z\.\-]+/,
                    cI: !0,
                    k: {
                        keyword: "if else foreach return function do while until elseif begin for trap data dynamicparam end break throw param continue finally in switch exit filter try process catch",
                        built_in: dbatoolscommands + " Add-Computer Add-Content Add-History Add-JobTrigger Add-Member Add-PSSnapin Add-Type Checkpoint-Computer Clear-Content Clear-EventLog Clear-History Clear-Host Clear-Item Clear-ItemProperty Clear-Variable Compare-Object Complete-Transaction Connect-PSSession Connect-WSMan Convert-Path ConvertFrom-Csv ConvertFrom-Json ConvertFrom-SecureString ConvertFrom-StringData ConvertTo-Csv ConvertTo-Html ConvertTo-Json ConvertTo-SecureString ConvertTo-Xml Copy-Item Copy-ItemProperty Debug-Process Disable-ComputerRestore Disable-JobTrigger Disable-PSBreakpoint Disable-PSRemoting Disable-PSSessionConfiguration Disable-WSManCredSSP Disconnect-PSSession Disconnect-WSMan Disable-ScheduledJob Enable-ComputerRestore Enable-JobTrigger Enable-PSBreakpoint Enable-PSRemoting Enable-PSSessionConfiguration Enable-ScheduledJob Enable-WSManCredSSP Enter-PSSession Exit-PSSession Export-Alias Export-Clixml Export-Console Export-Counter Export-Csv Export-FormatData Export-ModuleMember Export-PSSession ForEach-Object Format-Custom Format-List Format-Table Format-Wide Get-Acl Get-Alias Get-AuthenticodeSignature Get-ChildItem Get-Command Get-ComputerRestorePoint Get-Content Get-ControlPanelItem Get-Counter Get-Credential Get-Culture Get-Date Get-Event Get-EventLog Get-EventSubscriber Get-ExecutionPolicy Get-FormatData Get-Host Get-HotFix Get-Help Get-History Get-IseSnippet Get-Item Get-ItemProperty Get-Job Get-JobTrigger Get-Location Get-Member Get-Module Get-PfxCertificate Get-Process Get-PSBreakpoint Get-PSCallStack Get-PSDrive Get-PSProvider Get-PSSession Get-PSSessionConfiguration Get-PSSnapin Get-Random Get-ScheduledJob Get-ScheduledJobOption Get-Service Get-TraceSource Get-Transaction Get-TypeData Get-UICulture Get-Unique Get-Variable Get-Verb Get-WinEvent Get-WmiObject Get-WSManCredSSP Get-WSManInstance Group-Object Import-Alias Import-Clixml Import-Counter Import-Csv Import-IseSnippet Import-LocalizedData Import-PSSession Import-Module Invoke-AsWorkflow Invoke-Command Invoke-Expression Invoke-History Invoke-Item Invoke-RestMethod Invoke-WebRequest Invoke-WmiMethod Invoke-WSManAction Join-Path Limit-EventLog Measure-Command Measure-Object Move-Item Move-ItemProperty New-Alias New-Event New-EventLog New-IseSnippet New-Item New-ItemProperty New-JobTrigger New-Object New-Module New-ModuleManifest New-PSDrive New-PSSession New-PSSessionConfigurationFile New-PSSessionOption New-PSTransportOption New-PSWorkflowExecutionOption New-PSWorkflowSession New-ScheduledJobOption New-Service New-TimeSpan New-Variable New-WebServiceProxy New-WinEvent New-WSManInstance New-WSManSessionOption Out-Default Out-File Out-GridView Out-Host Out-Null Out-Printer Out-String Pop-Location Push-Location Read-Host Receive-Job Register-EngineEvent Register-ObjectEvent Register-PSSessionConfiguration Register-ScheduledJob Register-WmiEvent Remove-Computer Remove-Event Remove-EventLog Remove-Item Remove-ItemProperty Remove-Job Remove-JobTrigger Remove-Module Remove-PSBreakpoint Remove-PSDrive Remove-PSSession Remove-PSSnapin Remove-TypeData Remove-Variable Remove-WmiObject Remove-WSManInstance Rename-Computer Rename-Item Rename-ItemProperty Reset-ComputerMachinePassword Resolve-Path Restart-Computer Restart-Service Restore-Computer Resume-Job Resume-Service Save-Help Select-Object Select-String Select-Xml Send-MailMessage Set-Acl Set-Alias Set-AuthenticodeSignature Set-Content Set-Date Set-ExecutionPolicy Set-Item Set-ItemProperty Set-JobTrigger Set-Location Set-PSBreakpoint Set-PSDebug Set-PSSessionConfiguration Set-ScheduledJob Set-ScheduledJobOption Set-Service Set-StrictMode Set-TraceSource Set-Variable Set-WmiInstance Set-WSManInstance Set-WSManQuickConfig Show-Command Show-ControlPanelItem Show-EventLog Sort-Object Split-Path Start-Job Start-Process Start-Service Start-Sleep Start-Transaction Start-Transcript Stop-Computer Stop-Job Stop-Process Stop-Service Stop-Transcript Suspend-Job Suspend-Service Tee-Object Test-ComputerSecureChannel Test-Connection Test-ModuleManifest Test-Path Test-PSSessionConfigurationFile Trace-Command Unblock-File Undo-Transaction Unregister-Event Unregister-PSSessionConfiguration Unregister-ScheduledJob Update-FormatData Update-Help Update-List Update-TypeData Use-Transaction Wait-Event Wait-Job Wait-Process Where-Object Write-Debug Write-Error Write-EventLog Write-Host Write-Output Write-Progress Write-Verbose Write-Warning Add-MDTPersistentDrive Disable-MDTMonitorService Enable-MDTMonitorService Get-MDTDeploymentShareStatistics Get-MDTMonitorData Get-MDTOperatingSystemCatalog Get-MDTPersistentDrive Import-MDTApplication Import-MDTDriver Import-MDTOperatingSystem Import-MDTPackage Import-MDTTaskSequence New-MDTDatabase Remove-MDTMonitorData Remove-MDTPersistentDrive Restore-MDTPersistentDrive Set-MDTMonitorData Test-MDTDeploymentShare Test-MDTMonitorData Update-MDTDatabaseSchema Update-MDTDeploymentShare Update-MDTLinkedDS Update-MDTMedia Update-MDTMedia Add-VamtProductKey Export-VamtData Find-VamtManagedMachine Get-VamtConfirmationId Get-VamtProduct Get-VamtProductKey Import-VamtData Initialize-VamtData Install-VamtConfirmationId Install-VamtProductActivation Install-VamtProductKey Update-VamtProduct",
                        nomarkup: "-ne -eq -lt -gt -ge -le -not -like -notlike -match -notmatch -contains -notcontains -in -notin -replace"
                    },
                    c: [t, e.NM, n, a, r, o, s]
                }
            });

        }
        $(document).ready(function () {
            function render_doc(doc_to_render, examples_mode) {
                
                $("#rendered h5").each(function (i, el) {
                    if ($(el).text().startsWith('-')) {
                        $(el).addClass('param')
                    }
                })
                $('#rendered table').addClass('table table-sm table-hover')
                if (examples_mode == 'new') {
                    $('#rendered code').addClass('powershell')
                }
                $('#rendered code').each(function (i, block) {
                    hljs.highlightBlock(block);
                })
                var authorcontent = $("td:contains('Author')").next('td').addClass('dbatools_author').text()
                $("#rendered .dbatools_author").html(Autolinker.link(authorcontent, {
                    className: 'myLink',
                    mention: 'twitter'
                })
                )
                $("#rendered h2#syntax").next().find('code').addClass('wrapped')
                if (ClipboardJS.isSupported()) {
                    $("#rendered h5[id^='example-']").append('<div class="bd-clipboard"><button class="btn-clipboard" title="Copy to clipboard">Copy</button></div>')
                    new ClipboardJS('.btn-clipboard', {
                        text: function (trigger) {
                            var textlines = $(trigger).parent().parent().next('pre').find('code').text().split('\n')
                            var copied = []
                            _.forEach(textlines, function (row) {
                                copied.push(row.replace(/^PS C:\\> /, "").replace(/^>>/, ""))
                            })
                            return _.join(copied, '\n')
                        }
                    });
                }


                //not all code is a block 
                $("#rendered h3[id*='-parameters']").nextAll().find('code').addClass('hljs-inline')
                $('#rendered #description').nextUntil('#rendered #syntax').find('code').addClass('hljs-inline')
            }

            $('#loader').removeClass('invisible')
            var index_url = 'assets/dbatools-index.json'
            var external_url = 'assets/external.json'
            var values = [];
            var options = {
                valueNames: ['CommandName', 'Description', 'Alias', 'Examples', 'Params'],
                item: '<a class="list-group-item" href="#"><span class="CommandName"></span></a>'
            }
            cmdlist = new List('cmdlist', options, values);
            var indexhelp = ''
            var allcmds = $.getJSON(index_url, function (data) {
                indexhelp = data
                cmdlist.add(data)
                var dbacommands = []
                var cloudlist = {}
                _.forEach(data, function (el) {
                    dbacommands.push(el.CommandName)
                    if (_.isArray(el.Tags)) {
                        _.forEach(el.Tags, function (el) {
                            if (!_.has(cloudlist, el)) {
                                cloudlist[el] = 0
                            }
                            cloudlist[el] += 1
                        })
                    } else if (!_.isUndefined(el.Tags)){
                        if (!_.has(cloudlist, el.Tags)) {
                            cloudlist[el.Tags] = 0
                        }
                        cloudlist[el.Tags] += 1
                    }
                })
                var weightedVals = []
                _.forEach(cloudlist, function (value, key) {
                    weightedVals.push({
                        text: key,
                        weight: value,
                        handlers: {
                            click: function () { $('#search-ft').val('tag:' + key).trigger('keyup') }
                        }
                    })
                })
                var pixelHeight = window.innerHeight * 0.65;
                $('#canvas').css({ 'height': pixelHeight + 'px' });
                $('#canvas').jQCloud(weightedVals, {
                    autoResize: true
                });

                register_dbatools_hljs(dbacommands.join(' '))
                $(window).trigger('hashchange');
            })
            var options2 = {
                valueNames: ['extName', { name: 'extHref', attr: 'href' }],
                item: '<div><a class="list-group-item list-group-item-secondary extHref" href="#" _target="_blank"><span class="extName"></span></a></div>'
            }
            extlist = new List('extlist', options2, [])

            $.getJSON(external_url, function (data) {
                $('#dbatools_version').text('(v ' + data.version + ')')
                _.forEach(data.external_links, function (el) {
                    extlist.add({ 'extName': el.name, 'extHref': el.href })
                })
            })
            cmdlist.on('searchComplete', function (e) {
                if (cmdlist.matchingItems.length === 0) {
                    var searchString = $('#search-ft').val().trim();
                    if (searchString.length > 0 && !searchString.startsWith("ft:")) {
                        if (searchString != "f" && searchString != "ft" && searchString != "ft:") {
                            $('#search-ft').val("ft:" + searchString)
                        }
                    }
                }
            })
            $(document).on('mouseenter', '#cmdlist', function (e) {
                $('#search-ft').blur();
            })
            cmdlist.on('updated', function() {
                $('#cmdlist a').each(function(i, el) {
                    $(el).attr('href', $(el).find('span.CommandName').text())
                })
            })
            $('#cmdlist').on('mouseenter', 'a', function (e) {
                $(this).attr('href', $(this).find('span.CommandName').text());
                /*
                e.preventDefault();
                window.location.href = $(this).find('span.CommandName').text()
                ---
                window.location.hash = '#' + $(this).find('span.CommandName').text();
                $('#cmdlist').find('a.active').removeClass('active')
                $(this).addClass('active')
                */
            })
            $('#search-ft').bind('change keyup', function () {
                var searchString = $(this).val();
                if (searchString.trim() == "ft:" || searchString.trim() == "tag:") {
                    extlist.search();
                }
                else if (searchString.startsWith("ft:")) {
                    searchString = searchString.substring(3).trim();
                    if (cmdlist.filtered) {
                        cmdlist.filter();
                    }
                    cmdlist.search(searchString, ['CommandName', 'Alias', 'Description', 'Synopsis', 'Examples', 'Params']);
                } else if (searchString.startsWith("tag:")) {
                    searchString = searchString.substring(4).trim();
                    if (cmdlist.searched) {
                        cmdlist.search();
                    }
                    cmdlist.filter(function (item) {
                        if (_.indexOf(item.values().Tags, searchString) !== -1) {
                            return true;
                        } else {
                            return false;
                        }
                    });
                } else {
                    if (cmdlist.filtered) {
                        cmdlist.filter();
                    }
                    cmdlist.search(searchString, ['CommandName', 'Alias']);
                }
                extlist.search('$$$')
                if (_.isEmpty(searchString)) {
                    extlist.search()
                    cmdlist.filter()
                }
            })
            $('#clear-search').on('click', function () {
                $('#search-ft').val('').trigger('keyup')
            })
            $(window).on('hashchange', function (e) {
                var hash = window.location.hash.substr(1);
                var pagename = window.location.pathname.split("/").filter(function (c) { return c.length; }).pop();
                if (_.isUndefined(pagename)) {
                    pagename = ''
                } else {
                    pagename = pagename.split('.')[0];
                }
                if (hash.length == 0) {
                    hash = pagename
                }
                if (hash.length > 0) {
                    //ends with /
                    if (_.endsWith(hash, '/')) {
                        window.location.hash = '#' + hash.slice(0, hash.length - 1)
                        $(window).trigger('hashchange');
                        return;
                    }
                    //exact match
                    var topublish = _.findIndex(indexhelp, { 'Name': hash })
                    if (topublish == -1) {
                        //lowercase match
                        var topublish = _.findIndex(indexhelp, function (el) { return _.toLower(el.Name) == _.toLower(hash) })
                        if (topublish == -1) {
                            //alias match
                            var topublish = _.findIndex(indexhelp, { 'Alias': hash })
                            if (topublish == -1) {
                                //lowercase alias match
                                var topublish = _.findIndex(indexhelp, function (el) { return _.toLower(el.Alias) == _.toLower(hash) })
                            }
                            if (topublish == -1) {
                                //multiple aliases, optionally lowercased
                                var topublish = _.findIndex(indexhelp, function (el) { return _.includes(_.toLower(el.Alias).split(','), _.toLower(hash)) })
                            }
                        }
                        if (topublish !== -1) {
                            //normalization of URI
                            window.location.hash = '#' + indexhelp[topublish].CommandName
                            $(window).trigger('hashchange')
                            return;
                        }
                    }
                    if (topublish == -1) {
                        $('#rendered').html(marked.parse('### 404 Function not found \n (while searching for ' + hash + '). Please visit dbatools.io/commands for an updated index of current commands.'));
                    } else {
                        var doc_to_render = indexhelp[topublish]
                        render_doc(doc_to_render, 'new')
                        $("body").data("doc_to_render", indexhelp[topublish])
                        if ($("#headscroll").offset().top > 150) {
                            $(window).scrollTo('#headscroll')
                        } else {
                            $(window).scrollTo(0, 800)
                        }
                    }
                } else {
                    $('#loader').addClass('invisible')
                }
            })
            $(window).scroll(function () {
                if ($(this).scrollTop() > 50) {
                    $('#back-to-top').fadeIn();
                } else {
                    $('#back-to-top').fadeOut();
                }
            })
            $('#back-to-top').click(function () {
                $(window).scrollTo(0, 800)
                return false;
            })

        })
    </script>
</head>


<body>

    <nav class="navbar navbar-expand-md customnav">
        <a href="https://docs.dbatools.io/" class="navbar-brand" rel="home" itemprop="url">
            <img width="265" height="64" src="https://dbatools.io/wp-content/uploads/2018/09/dbatools-docs.png"
                class="custom-logo" alt="dbatools" itemprop="logo" scale="0">
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse"
            aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
            <span class="oi oi-menu"></span>
        </button>
        <div class="collapse navbar-collapse flex-grow-1 text-right" id="navbarCollapse">
            <ul class="navbar-nav ml-auto flex-nowrap">
                <li class="nav-item">
                    <a class="nav-link" style="color:#293E5D" href="https://dbatools.io/download/">⬇ download</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" style="color:#293E5D" href="https://dbatools.io/commands/">🚀 commands</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" style="color:#293E5D" href="https://dbatools.io/slack">🔍 find us</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" style="color:#293E5D" href="https://dbatools.io/builds">🔢 build ref</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" style="color:#293E5D" href="https://dbatools.io/book">📘 dbatools book</a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <hr />
            </div>
        </div>
        <div class="row">
            <div class="col-xl-3 col-lg-5 col-md-5 col-sm-12 bd-sidebar">
                <div id="relcommands" class="">
                    <h3>
                        commands
                        <small id="dbatools_version" class="text-muted"></small>
                    </h3>
                    <p></p>
                    <div class="form-group row">
                        <div class="col-lg-12">
                            <div class="input-group">

                                <input type="text" class="form-control" id="search-ft"
                                    placeholder="Search (&quot;ft: term&quot; enables fulltext)" autocomplete="off">
                                <div class="input-group-append">
                                    <div class="input-group-text" id="clear-search">Clear</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="extlist">
                        <div class="list list-group"></div>
                    </div>
                    <div id="cmdlist">
                        <div class="list list-group"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-9 col-lg-7 col-md-7 col-sm-12 bd-content">
                <div id="headscroll">
                    <a id="back-to-top" href="#" class="btn btn-primary btn-lg back-to-top" role="button"
                        title="Click to return on the top page">&#94;</a>
                </div>
                <div id="rendered">
                    <h1 id="connect-dbainstance">Connect-DbaInstance</h1>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Author</strong></td>
<td>Chrissy LeMaire (@cl), netnerds.net</td>
</tr>
<tr>
<td><strong>Availability</strong></td>
<td>Windows, Linux, macOS</td>
</tr>
</tbody>
</table>
<p> </p>
<p><em>Aliases : cdi</em></p>
<p> </p>
<p>Want to see the source code for this command? Check out <a href="https://github.com/dataplat/dbatools/blob/master/functions/Connect-DbaInstance.ps1">Connect-DbaInstance</a> on GitHub.
<br>
Want to see the Bill Of Health for this command? Check out <a href="https://dataplat.github.io/boh#Connect-DbaInstance">Connect-DbaInstance</a>.</p>
<h2 id="synopsis">Synopsis</h2>
<p>Creates a robust, reusable SQL Server object.</p>
<h2 id="description">Description</h2>
<p>This command creates a robust, reusable sql server object.</p>
<p>It is robust because it initializes properties that do not cause enumeration by default. It also supports both Windows and SQL Server authentication methods, and detects which to use based upon the provided credentials.</p>
<p>By default, this command also sets the connection's ApplicationName property  to &quot;dbatools PowerShell module - dbatools.io - custom connection&quot;. If you're doing anything that requires profiling, you can look for this client name.</p>
<p>Alternatively, you can pass in whichever client name you'd like using the -ClientName parameter. There are a ton of other parameters for you to explore as well.</p>
<p>See <a href="https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.connectionstring.aspx">https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.connectionstring.aspx</a>
and <a href="https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnectionstringbuilder.aspx">https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnectionstringbuilder.aspx</a>,
and <a href="https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.aspx">https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.aspx</a></p>
<p>To execute SQL commands, you can use $server.ConnectionContext.ExecuteReader($sql) or $server.Databases['master'].ExecuteNonQuery($sql)</p>
<h2 id="syntax">Syntax</h2>
<pre><code>Connect-DbaInstance
    [-SqlInstance] &lt;DbaInstanceParameter[]&gt;
    [[-SqlCredential] &lt;PSCredential&gt;]
    [[-Database] &lt;String&gt;]
    [[-ApplicationIntent] &lt;String&gt;]
    [-AzureUnsupported]
    [[-BatchSeparator] &lt;String&gt;]
    [[-ClientName] &lt;String&gt;]
    [[-ConnectTimeout] &lt;Int32&gt;]
    [-EncryptConnection]
    [[-FailoverPartner] &lt;String&gt;]
    [[-LockTimeout] &lt;Int32&gt;]
    [[-MaxPoolSize] &lt;Int32&gt;]
    [[-MinPoolSize] &lt;Int32&gt;]
    [[-MinimumVersion] &lt;Int32&gt;]
    [-MultipleActiveResultSets]
    [-MultiSubnetFailover]
    [[-NetworkProtocol] &lt;String&gt;]
    [-NonPooledConnection]
    [[-PacketSize] &lt;Int32&gt;]
    [[-PooledConnectionLifetime] &lt;Int32&gt;]
    [[-SqlExecutionModes] &lt;String&gt;]
    [[-StatementTimeout] &lt;Int32&gt;]
    [-TrustServerCertificate]
    [[-WorkstationId] &lt;String&gt;]
    [-AlwaysEncrypted]
    [[-AppendConnectionString] &lt;String&gt;]
    [-SqlConnectionOnly]
    [[-AzureDomain] &lt;String&gt;]
    [[-Tenant] &lt;String&gt;]
    [[-AccessToken] &lt;PSObject&gt;]
    [-DedicatedAdminConnection]
    [-DisableException]
    [&lt;CommonParameters&gt;]

</code></pre>
<p> </p>
<h2 id="examples">Examples</h2>
<p> </p>
<h5 id="example-1">Example:  1</h5>
<pre><code>PS C:\&gt; Connect-DbaInstance -SqlInstance sql2014
</code></pre>
<p>Creates an SMO Server object that connects using Windows Authentication<br></p>
<h5 id="example-2">Example:  2</h5>
<pre><code>PS C:\&gt; $wincred = Get-Credential ad\sqladmin
PS C:\&gt; Connect-DbaInstance -SqlInstance sql2014 -SqlCredential $wincred
</code></pre>
<p>Creates an SMO Server object that connects using alternative Windows credentials<br></p>
<h5 id="example-3">Example:  3</h5>
<pre><code>PS C:\&gt; $sqlcred = Get-Credential sqladmin
PS C:\&gt; $server = Connect-DbaInstance -SqlInstance sql2014 -SqlCredential $sqlcred
</code></pre>
<p>Login to sql2014 as SQL login sqladmin.<br></p>
<h5 id="example-4">Example:  4</h5>
<pre><code>PS C:\&gt; $server = Connect-DbaInstance -SqlInstance sql2014 -ClientName &quot;my connection&quot;
</code></pre>
<p>Creates an SMO Server object that connects using Windows Authentication and uses the client name &quot;my connection&quot;.<br>
So when you open up profiler or use extended events, you can search for &quot;my connection&quot;.<br></p>
<h5 id="example-5">Example:  5</h5>
<pre><code>PS C:\&gt; $server = Connect-DbaInstance -SqlInstance sql2014 -AppendConnectionString &quot;Packet Size=4096;AttachDbFilename=C:\MyFolder\MyDataFile.mdf;User Instance=true;&quot;
</code></pre>
<p>Creates an SMO Server object that connects to sql2014 using Windows Authentication, then it sets the packet size (this can also be done via -PacketSize) and other connection attributes.<br></p>
<h5 id="example-6">Example:  6</h5>
<pre><code>PS C:\&gt; $server = Connect-DbaInstance -SqlInstance sql2014 -NetworkProtocol TcpIp -MultiSubnetFailover
</code></pre>
<p>Creates an SMO Server object that connects using Windows Authentication that uses TCP/IP and has MultiSubnetFailover enabled.<br></p>
<h5 id="example-7">Example:  7</h5>
<pre><code>PS C:\&gt; $server = Connect-DbaInstance sql2016 -ApplicationIntent ReadOnly
</code></pre>
<p>Connects with ReadOnly ApplicationIntent.<br></p>
<h5 id="example-8">Example:  8</h5>
<pre><code>PS C:\&gt; $server = Connect-DbaInstance -SqlInstance myserver.database.windows.net -Database mydb -SqlCredential me@mydomain.onmicrosoft.com -DisableException
PS C:\&gt; Invoke-DbaQuery -SqlInstance $server -Query &quot;select 1 as test&quot;
</code></pre>
<p>Logs into Azure SQL DB using AAD / Azure Active Directory, then performs a sample query.<br></p>
<h5 id="example-9">Example:  9</h5>
<pre><code>PS C:\&gt; $server = Connect-DbaInstance -SqlInstance psdbatools.database.windows.net -Database dbatools -DisableException
PS C:\&gt; Invoke-DbaQuery -SqlInstance $server -Query &quot;select 1 as test&quot;
</code></pre>
<p>Logs into Azure SQL DB using AAD Integrated Auth, then performs a sample query.<br></p>
<h5 id="example-10">Example:  10</h5>
<pre><code>PS C:\&gt; $server = Connect-DbaInstance -SqlInstance &quot;myserver.public.cust123.database.windows.net,3342&quot; -Database mydb -SqlCredential me@mydomain.onmicrosoft.com -DisableException
PS C:\&gt; Invoke-DbaQuery -SqlInstance $server -Query &quot;select 1 as test&quot;
</code></pre>
<p>Logs into Azure SQL Managed instance using AAD / Azure Active Directory, then performs a sample query.<br></p>
<h5 id="example-11">Example:  11</h5>
<pre><code>PS C:\&gt; $server = Connect-DbaInstance -SqlInstance db.mycustomazure.com -Database mydb -AzureDomain mycustomazure.com -DisableException
PS C:\&gt; Invoke-DbaQuery -SqlInstance $server -Query &quot;select 1 as test&quot;
</code></pre>
<p>In the event your AzureSqlDb is not on a database.windows.net domain, you can set a custom domain using the AzureDomain parameter.<br>
This tells Connect-DbaInstance to login to the database using the method that works best with Azure.<br></p>
<h5 id="example-12">Example:  12</h5>
<pre><code>PS C:\&gt; $connstring = &quot;Data Source=TCP:mydb.database.windows.net,1433;User ID=sqladmin;Password=adfasdf;Connect Timeout=30;&quot;
PS C:\&gt; $server = Connect-DbaInstance -ConnectionString $connstring
PS C:\&gt; Invoke-DbaQuery -SqlInstance $server -Query &quot;select 1 as test&quot;
</code></pre>
<p>Logs into Azure using a preconstructed connstring, then performs a sample query.<br>
ConnectionString is an alias of SqlInstance, so you can use -SqlInstance $connstring as well.<br></p>
<h5 id="example-13">Example:  13</h5>
<pre><code>PS C:\&gt; $cred = Get-Credential guid-app-id-here # appid for username, clientsecret for password
PS C:\&gt; $server = Connect-DbaInstance -SqlInstance psdbatools.database.windows.net -Database abc -SqlCredential $cred -Tenant guidheremaybename
PS C:\&gt; Invoke-DbaQuery -SqlInstance $server -Query &quot;select 1 as test&quot;
</code></pre>
<p>When connecting from a non-Azure workstation, logs into Azure using Universal with MFA Support with a username and password, then performs a sample query.<br>
Note that generating access tokens is not supported on Core, so when using Tenant on Core, we rewrite the connection string with Active Directory Service Principal authentication instead.<br></p>
<h5 id="example-14">Example:  14</h5>
<pre><code>PS C:\&gt; $cred = Get-Credential guid-app-id-here # appid for username, clientsecret for password
PS C:\&gt; Set-DbatoolsConfig -FullName azure.tenantid -Value 'guidheremaybename' -Passthru | Register-DbatoolsConfig
PS C:\&gt; Set-DbatoolsConfig -FullName azure.appid -Value $cred.Username -Passthru | Register-DbatoolsConfig
PS C:\&gt; Set-DbatoolsConfig -FullName azure.clientsecret -Value $cred.Password -Passthru | Register-DbatoolsConfig # requires securestring
PS C:\&gt; Set-DbatoolsConfig -FullName sql.connection.database -Value abc -Passthru | Register-DbatoolsConfig
PS C:\&gt; Connect-DbaInstance -SqlInstance psdbatools.database.windows.net
</code></pre>
<p>Permanently sets some app id config values. To set them temporarily (just for a session), remove -Passthru | Register-DbatoolsConfig<br>
When connecting from a non-Azure workstation or an Azure VM without .NET 4.7.2 and higher, logs into Azure using Universal with MFA Support, then performs a sample query.<br></p>
<h5 id="example-15">Example:  15</h5>
<pre><code>PS C:\&gt; $azureCredential = Get-Credential -Message 'Azure Credential'
PS C:\&gt; $azureAccount = Connect-AzAccount -Credential $azureCredential
PS C:\&gt; $azureToken = Get-AzAccessToken -ResourceUrl https://database.windows.net
PS C:\&gt; $azureInstance = &quot;YOURSERVER.database.windows.net&quot;
PS C:\&gt; $azureDatabase = &quot;MYDATABASE&quot;
PS C:\&gt; $server = Connect-DbaInstance -SqlInstance $azureInstance -Database $azureDatabase -AccessToken $azureToken
PS C:\&gt; Invoke-DbaQuery -SqlInstance $server -Query &quot;select 1 as test&quot;
</code></pre>
<p>Connect to an Azure SQL Database or an Azure SQL Managed Instance with an AccessToken.<br>
Note that the token is valid for only one hour and cannot be renewed automatically.<br></p>
<h5 id="example-16">Example:  16</h5>
<pre><code>PS C:\&gt; $token = New-DbaAzAccessToken -Type RenewableServicePrincipal -Subtype AzureSqlDb -Tenant $tenantid -Credential $cred
PS C:\&gt; Connect-DbaInstance -SqlInstance sample.database.windows.net -Accesstoken $token
</code></pre>
<p>Uses dbatools to generate the access token for an Azure SQL Database, then logs in using that AccessToken.<br></p>
<h5 id="example-17">Example:  17</h5>
<pre><code>PS C:\&gt; $server = Connect-DbaInstance -SqlInstance srv1 -DedicatedAdminConnection
PS C:\&gt; $dbaProcess = Get-DbaProcess -SqlInstance $server -ExcludeSystemSpids
PS C:\&gt; $killedProcess = $dbaProcess | Out-GridView -OutputMode Multiple | Stop-DbaProcess
PS C:\&gt; $server | Disconnect-DbaInstance
</code></pre>
<p>Creates a dedicated admin connection (DAC) to the default instance on server srv1.<br>
Receives all non-system processes from the instance using the DAC.<br>
Opens a grid view to let the user select processes to be stopped.<br>
Closes the connection.<br></p>
<h3 id="required-parameters">Required Parameters</h3>
<h5 id="sqlinstance">-SqlInstance</h5>
<p>The target SQL Server instance or instances. This can be a collection and receive pipeline input to allow the function to be executed against multiple SQL Server instances.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td>Connstring,ConnectionString</td>
</tr>
<tr>
<td>Required</td>
<td>True</td>
</tr>
<tr>
<td>Pipeline</td>
<td>true (ByValue)</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="optional-parameters">Optional Parameters</h3>
<h5 id="sqlcredential">-SqlCredential</h5>
<p>Credential object used to connect to the SQL Server Instance as a different user. This can be a Windows or SQL Server account. Windows users are determined by the existence of a backslash, so if you
are intending to use an alternative Windows connection instead of a SQL login, ensure it contains a backslash.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="database">-Database</h5>
<p>The database(s) to process. This list is auto-populated from the server.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>(Get-DbatoolsConfigValue -FullName 'sql.connection.database')</td>
</tr>
</tbody>
</table>
<h5 id="applicationintent">-ApplicationIntent</h5>
<p>Declares the application workload type when connecting to a server.
Valid values are &quot;ReadOnly&quot; and &quot;ReadWrite&quot;.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
<tr>
<td>Accepted Values</td>
<td>ReadOnly,ReadWrite</td>
</tr>
</tbody>
</table>
<h5 id="azureunsupported">-AzureUnsupported</h5>
<p>Terminate if Azure is detected but not supported<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>False</td>
</tr>
</tbody>
</table>
<h5 id="batchseparator">-BatchSeparator</h5>
<p>A string to separate groups of SQL statements being executed. By default, this is &quot;GO&quot;.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="clientname">-ClientName</h5>
<p>By default, this command sets the client's ApplicationName property to &quot;dbatools PowerShell module - dbatools.io&quot;. If you're doing anything that requires profiling, you can look for this client name.
Using -ClientName allows you to set your own custom client application name.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>(Get-DbatoolsConfigValue -FullName 'sql.connection.clientname')</td>
</tr>
</tbody>
</table>
<h5 id="connecttimeout">-ConnectTimeout</h5>
<p>The length of time (in seconds) to wait for a connection to the server before terminating the attempt and generating an error.
Valid values are integers between 0 and 2147483647.
When opening a connection to a Azure SQL Database, set the connection timeout to 30 seconds.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>([Dataplat.Dbatools.Connection.ConnectionHost]::SqlConnectionTimeout)</td>
</tr>
</tbody>
</table>
<h5 id="encryptconnection">-EncryptConnection</h5>
<p>If this switch is enabled, SQL Server uses SSL encryption for all data sent between the client and server if the server has a certificate installed.
For more information, see Connection String Syntax. <a href="https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/connection-string-syntax">https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/connection-string-syntax</a>
Beginning in .NET Framework 4.5, when TrustServerCertificate is false and Encrypt is true, the server name (or IP address) in a SQL Server SSL certificate must exactly match the server name (or IP
address) specified in the connection string. Otherwise, the connection attempt will fail. For information about support for certificates whose subject starts with a wildcard character (*), see
Accepted wildcards used by server certificates for server authentication. <a href="https://support.microsoft.com/en-us/help/258858/accepted-wildcards-used-by-server-certificates-for-server-authenticati">https://support.microsoft.com/en-us/help/258858/accepted-wildcards-used-by-server-certificates-for-server-authenticati</a><br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>(Get-DbatoolsConfigValue -FullName 'sql.connection.encrypt')</td>
</tr>
</tbody>
</table>
<h5 id="failoverpartner">-FailoverPartner</h5>
<p>The name of the failover partner server where database mirroring is configured.
If the value of this key is &quot;&quot; (an empty string), then Initial Catalog must be present in the connection string, and its value must not be &quot;&quot;.
The server name can be 128 characters or less.
If you specify a failover partner but the failover partner server is not configured for database mirroring and the primary server (specified with the Server keyword) is not available, then the
connection will fail.
If you specify a failover partner and the primary server is not configured for database mirroring, the connection to the primary server (specified with the Server keyword) will succeed if the primary
server is available.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="locktimeout">-LockTimeout</h5>
<p>Sets the time in seconds required for the connection to time out when the current transaction is locked.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>0</td>
</tr>
</tbody>
</table>
<h5 id="maxpoolsize">-MaxPoolSize</h5>
<p>Sets the maximum number of connections allowed in the connection pool for this specific connection string.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>0</td>
</tr>
</tbody>
</table>
<h5 id="minpoolsize">-MinPoolSize</h5>
<p>Sets the minimum number of connections allowed in the connection pool for this specific connection string.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>0</td>
</tr>
</tbody>
</table>
<h5 id="minimumversion">-MinimumVersion</h5>
<p>Terminate if the target SQL Server instance version does not meet version requirements<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>0</td>
</tr>
</tbody>
</table>
<h5 id="multipleactiveresultsets">-MultipleActiveResultSets</h5>
<p>If this switch is enabled, an application can maintain multiple active result sets (MARS).
If this switch is not enabled, an application must process or cancel all result sets from one batch before it can execute any other batch on that connection.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>False</td>
</tr>
</tbody>
</table>
<h5 id="multisubnetfailover">-MultiSubnetFailover</h5>
<p>If this switch is enabled, and your application is connecting to an AlwaysOn availability group (AG) on different subnets, detection of and connection to the currently active server will be faster.
For more information about SqlClient support for Always On Availability Groups, see
<a href="https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/sql/sqlclient-support-for-high-availability-disaster-recovery">https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/sql/sqlclient-support-for-high-availability-disaster-recovery</a><br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>(Get-DbatoolsConfigValue -FullName 'sql.connection.multisubnetfailover')</td>
</tr>
</tbody>
</table>
<h5 id="networkprotocol">-NetworkProtocol</h5>
<p>Explicitly sets the network protocol used to connect to the server.
Valid values are &quot;TcpIp&quot;,&quot;NamedPipes&quot;,&quot;Multiprotocol&quot;,&quot;AppleTalk&quot;,&quot;BanyanVines&quot;,&quot;Via&quot;,&quot;SharedMemory&quot; and &quot;NWLinkIpxSpx&quot;<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>(Get-DbatoolsConfigValue -FullName 'sql.connection.protocol')</td>
</tr>
<tr>
<td>Accepted Values</td>
<td>TcpIp,NamedPipes,Multiprotocol,AppleTalk,BanyanVines,Via,SharedMemory,NWLinkIpxSpx</td>
</tr>
</tbody>
</table>
<h5 id="nonpooledconnection">-NonPooledConnection</h5>
<p>If this switch is enabled, a non-pooled connection will be requested.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>False</td>
</tr>
</tbody>
</table>
<h5 id="packetsize">-PacketSize</h5>
<p>Sets the size in bytes of the network packets used to communicate with an instance of SQL Server. Must match at server.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>(Get-DbatoolsConfigValue -FullName 'sql.connection.packetsize')</td>
</tr>
</tbody>
</table>
<h5 id="pooledconnectionlifetime">-PooledConnectionLifetime</h5>
<p>When a connection is returned to the pool, its creation time is compared with the current time and the connection is destroyed if that time span (in seconds) exceeds the value specified by Connection
Lifetime. This is useful in clustered configurations to force load balancing between a running server and a server just brought online.
A value of zero (0) causes pooled connections to have the maximum connection timeout.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>0</td>
</tr>
</tbody>
</table>
<h5 id="sqlexecutionmodes">-SqlExecutionModes</h5>
<p>The SqlExecutionModes enumeration contains values that are used to specify whether the commands sent to the referenced connection to the server are executed immediately or saved in a buffer.
Valid values include &quot;CaptureSql&quot;, &quot;ExecuteAndCaptureSql&quot; and &quot;ExecuteSql&quot;.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
<tr>
<td>Accepted Values</td>
<td>CaptureSql,ExecuteAndCaptureSql,ExecuteSql</td>
</tr>
</tbody>
</table>
<h5 id="statementtimeout">-StatementTimeout</h5>
<p>Sets the number of seconds a statement is given to run before failing with a timeout error.
The default is read from the configuration 'sql.execution.timeout' that is currently set to 0 (unlimited).
If you want to change this to 10 minutes, use: Set-DbatoolsConfig -FullName 'sql.execution.timeout' -Value 600<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>(Get-DbatoolsConfigValue -FullName 'sql.execution.timeout')</td>
</tr>
</tbody>
</table>
<h5 id="trustservercertificate">-TrustServerCertificate</h5>
<p>When this switch is enabled, the channel will be encrypted while bypassing walking the certificate chain to validate trust.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>(Get-DbatoolsConfigValue -FullName 'sql.connection.trustcert')</td>
</tr>
</tbody>
</table>
<h5 id="workstationid">-WorkstationId</h5>
<p>Sets the name of the workstation connecting to SQL Server.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="alwaysencrypted">-AlwaysEncrypted</h5>
<p>Sets &quot;Column Encryption Setting=enabled&quot; on the connection so you can work with Always Encrypted values.
For more information, see <a href="https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/develop-using-always-encrypted-with-net-framework-data-provider">https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/develop-using-always-encrypted-with-net-framework-data-provider</a><br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>False</td>
</tr>
</tbody>
</table>
<h5 id="appendconnectionstring">-AppendConnectionString</h5>
<p>Appends to the current connection string. Note that you cannot pass authentication information using this method. Use -SqlInstance and optionally -SqlCredential to set authentication information.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="sqlconnectiononly">-SqlConnectionOnly</h5>
<p>Instead of returning a rich SMO server object, this command will only return a SqlConnection object when setting this switch.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>False</td>
</tr>
</tbody>
</table>
<h5 id="azuredomain">-AzureDomain</h5>
<p>By default, this is set to database.windows.net
In the event your AzureSqlDb is not on a database.windows.net domain, you can set a custom domain using the AzureDomain parameter.
This tells Connect-DbaInstance to login to the database using the method that works best with Azure.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>database.windows.net</td>
</tr>
</tbody>
</table>
<h5 id="tenant">-Tenant</h5>
<p>The TenantId for an Azure Instance<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>(Get-DbatoolsConfigValue -FullName 'azure.tenantid')</td>
</tr>
</tbody>
</table>
<h5 id="accesstoken">-AccessToken</h5>
<p>Connect to an Azure SQL Database or an Azure SQL Managed Instance with an AccessToken, that has to be generated with Get-AzAccessToken or New-DbaAzAccessToken.
Note that the token is valid for only one hour and cannot be renewed automatically.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="dedicatedadminconnection">-DedicatedAdminConnection</h5>
<p>Connects using &quot;ADMIN:&quot; to create a dedicated admin connection (DAC) as a non-pooled connection.
If the instance is on a remote server, the remote access has to be enabled via &quot;Set-DbaSpConfigure -Name RemoteDacConnectionsEnabled -Value $true&quot; or &quot;sp_configure 'remote admin connections', 1&quot;.
The connection will not be closed if the variable holding the Server SMO is going out of scope, so it is very important to call .ConnectionContext.Disconnect() to close the connection. See example.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>False</td>
</tr>
</tbody>
</table>
<h5 id="disableexception">-DisableException</h5>
<p>By default in most of our commands, when something goes wrong we try to catch it, interpret it and give you a friendly warning message.
This command, however, gifts you  with &quot;sea of red&quot; exceptions, by default, because it is useful for advanced scripting.
Using this switch turns our &quot;nice by default&quot; feature on which makes errors into pretty warnings.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>False</td>
</tr>
</tbody>
</table>
<p> </p>

                </div> <!-- rendered -->
            </div>
        </div>
    </div>
</body>

</html>
