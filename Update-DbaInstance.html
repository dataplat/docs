<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=2.0">
    <title>dbatools docs | Update-DbaInstance</title>
    <link rel="icon" href="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png" sizes="32x32">
    <link rel="icon" href="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png" sizes="192x192">
    <link rel="apple-touch-icon-precomposed" href="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png">
    <meta name="msapplication-TileImage" content="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png">

    <link title="Search" rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml">
    <meta name="keywords" content="dbatools, ">
    <meta name="subtitle" content="Docs for Update-DbaInstance">
    <meta property="og:type" content="article" />
    <meta property="og:title" content="dbatools docs:  Update-DbaInstance" />
    <meta property="og:url" content="https://docs.dbatools.io/Update-DbaInstance.html" />
    <meta property="og:description" content="dbatools docs for Update-DbaInstance" />
    <meta property="og:site_name" content="docs.dbatools.io" />
    <meta property="og:locale" content="en_US" />
    <meta name="twitter:text:title" content="dbatools docs:  Update-DbaInstance" />
    <meta name="twitter:image" content="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png" />
    <meta name="twitter:card" content="summary" />

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css"
        href="//cdnjs.cloudflare.com/ajax/libs/open-iconic/1.1.1/font/css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" type="text/css"
        href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

    <link rel="stylesheet" href="assets/css/layout.css">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-80639740-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-80639740-2');
    </script>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
    <script src="//cdn.jsdelivr.net/npm/lodash@4.17.4/lodash.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="//cdn.jsdelivr.net/jquery.scrollto/2.1.2/jquery.scrollTo.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/autolinker/1.7.1/Autolinker.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jqcloud2@2.0.3/dist/jqcloud.min.js"
        integrity="sha256-+krhsKJpvd3AZYVGHcwyCUGO01uNdGSTvqR7Apcy30E=" crossorigin="anonymous"></script>

    <script type="text/javascript" language="javascript">
        function register_dbatools_hljs(dbatoolscommands) {

            hljs.registerLanguage("powershell", function (e) {
                var t = {
                    b: "`[\\s\\S]",
                    r: 0
                },
                    o = {
                        cN: "variable",
                        v: [{
                            b: /\$[\w\d][\w\d_:]*/
                        }]
                    },
                    r = {
                        cN: "literal",
                        b: /\$(null|true|false)\b/
                    },
                    n = {
                        cN: "string",
                        v: [{
                            b: /"/,
                            e: /"/
                        }, {
                            b: /@"/,
                            e: /^"@/
                        }],
                        c: [t, o, {
                            cN: "variable",
                            b: /\$[A-z]/,
                            e: /[^A-z]/
                        }]
                    },
                    a = {
                        cN: "string",
                        v: [{
                            b: /'/,
                            e: /'/
                        }, {
                            b: /@'/,
                            e: /^'@/
                        }]
                    },
                    i = {
                        cN: "doctag",
                        v: [{
                            b: /\.(synopsis|description|example|inputs|outputs|notes|link|component|role|functionality)/
                        }, {
                            b: /\.(parameter|forwardhelptargetname|forwardhelpcategory|remotehelprunspace|externalhelp)\s+\S+/
                        }]
                    },
                    s = e.inherit(e.C(null, null), {
                        v: [{
                            b: /#/,
                            e: /$/
                        }, {
                            b: /<#/,
                            e: /#>/
                        }],
                        c: [i]
                    });
                return {
                    aliases: ["ps"],
                    l: /-?[A-z\.\-]+/,
                    cI: !0,
                    k: {
                        keyword: "if else foreach return function do while until elseif begin for trap data dynamicparam end break throw param continue finally in switch exit filter try process catch",
                        built_in: dbatoolscommands + " Add-Computer Add-Content Add-History Add-JobTrigger Add-Member Add-PSSnapin Add-Type Checkpoint-Computer Clear-Content Clear-EventLog Clear-History Clear-Host Clear-Item Clear-ItemProperty Clear-Variable Compare-Object Complete-Transaction Connect-PSSession Connect-WSMan Convert-Path ConvertFrom-Csv ConvertFrom-Json ConvertFrom-SecureString ConvertFrom-StringData ConvertTo-Csv ConvertTo-Html ConvertTo-Json ConvertTo-SecureString ConvertTo-Xml Copy-Item Copy-ItemProperty Debug-Process Disable-ComputerRestore Disable-JobTrigger Disable-PSBreakpoint Disable-PSRemoting Disable-PSSessionConfiguration Disable-WSManCredSSP Disconnect-PSSession Disconnect-WSMan Disable-ScheduledJob Enable-ComputerRestore Enable-JobTrigger Enable-PSBreakpoint Enable-PSRemoting Enable-PSSessionConfiguration Enable-ScheduledJob Enable-WSManCredSSP Enter-PSSession Exit-PSSession Export-Alias Export-Clixml Export-Console Export-Counter Export-Csv Export-FormatData Export-ModuleMember Export-PSSession ForEach-Object Format-Custom Format-List Format-Table Format-Wide Get-Acl Get-Alias Get-AuthenticodeSignature Get-ChildItem Get-Command Get-ComputerRestorePoint Get-Content Get-ControlPanelItem Get-Counter Get-Credential Get-Culture Get-Date Get-Event Get-EventLog Get-EventSubscriber Get-ExecutionPolicy Get-FormatData Get-Host Get-HotFix Get-Help Get-History Get-IseSnippet Get-Item Get-ItemProperty Get-Job Get-JobTrigger Get-Location Get-Member Get-Module Get-PfxCertificate Get-Process Get-PSBreakpoint Get-PSCallStack Get-PSDrive Get-PSProvider Get-PSSession Get-PSSessionConfiguration Get-PSSnapin Get-Random Get-ScheduledJob Get-ScheduledJobOption Get-Service Get-TraceSource Get-Transaction Get-TypeData Get-UICulture Get-Unique Get-Variable Get-Verb Get-WinEvent Get-WmiObject Get-WSManCredSSP Get-WSManInstance Group-Object Import-Alias Import-Clixml Import-Counter Import-Csv Import-IseSnippet Import-LocalizedData Import-PSSession Import-Module Invoke-AsWorkflow Invoke-Command Invoke-Expression Invoke-History Invoke-Item Invoke-RestMethod Invoke-WebRequest Invoke-WmiMethod Invoke-WSManAction Join-Path Limit-EventLog Measure-Command Measure-Object Move-Item Move-ItemProperty New-Alias New-Event New-EventLog New-IseSnippet New-Item New-ItemProperty New-JobTrigger New-Object New-Module New-ModuleManifest New-PSDrive New-PSSession New-PSSessionConfigurationFile New-PSSessionOption New-PSTransportOption New-PSWorkflowExecutionOption New-PSWorkflowSession New-ScheduledJobOption New-Service New-TimeSpan New-Variable New-WebServiceProxy New-WinEvent New-WSManInstance New-WSManSessionOption Out-Default Out-File Out-GridView Out-Host Out-Null Out-Printer Out-String Pop-Location Push-Location Read-Host Receive-Job Register-EngineEvent Register-ObjectEvent Register-PSSessionConfiguration Register-ScheduledJob Register-WmiEvent Remove-Computer Remove-Event Remove-EventLog Remove-Item Remove-ItemProperty Remove-Job Remove-JobTrigger Remove-Module Remove-PSBreakpoint Remove-PSDrive Remove-PSSession Remove-PSSnapin Remove-TypeData Remove-Variable Remove-WmiObject Remove-WSManInstance Rename-Computer Rename-Item Rename-ItemProperty Reset-ComputerMachinePassword Resolve-Path Restart-Computer Restart-Service Restore-Computer Resume-Job Resume-Service Save-Help Select-Object Select-String Select-Xml Send-MailMessage Set-Acl Set-Alias Set-AuthenticodeSignature Set-Content Set-Date Set-ExecutionPolicy Set-Item Set-ItemProperty Set-JobTrigger Set-Location Set-PSBreakpoint Set-PSDebug Set-PSSessionConfiguration Set-ScheduledJob Set-ScheduledJobOption Set-Service Set-StrictMode Set-TraceSource Set-Variable Set-WmiInstance Set-WSManInstance Set-WSManQuickConfig Show-Command Show-ControlPanelItem Show-EventLog Sort-Object Split-Path Start-Job Start-Process Start-Service Start-Sleep Start-Transaction Start-Transcript Stop-Computer Stop-Job Stop-Process Stop-Service Stop-Transcript Suspend-Job Suspend-Service Tee-Object Test-ComputerSecureChannel Test-Connection Test-ModuleManifest Test-Path Test-PSSessionConfigurationFile Trace-Command Unblock-File Undo-Transaction Unregister-Event Unregister-PSSessionConfiguration Unregister-ScheduledJob Update-FormatData Update-Help Update-List Update-TypeData Use-Transaction Wait-Event Wait-Job Wait-Process Where-Object Write-Debug Write-Error Write-EventLog Write-Host Write-Output Write-Progress Write-Verbose Write-Warning Add-MDTPersistentDrive Disable-MDTMonitorService Enable-MDTMonitorService Get-MDTDeploymentShareStatistics Get-MDTMonitorData Get-MDTOperatingSystemCatalog Get-MDTPersistentDrive Import-MDTApplication Import-MDTDriver Import-MDTOperatingSystem Import-MDTPackage Import-MDTTaskSequence New-MDTDatabase Remove-MDTMonitorData Remove-MDTPersistentDrive Restore-MDTPersistentDrive Set-MDTMonitorData Test-MDTDeploymentShare Test-MDTMonitorData Update-MDTDatabaseSchema Update-MDTDeploymentShare Update-MDTLinkedDS Update-MDTMedia Update-MDTMedia Add-VamtProductKey Export-VamtData Find-VamtManagedMachine Get-VamtConfirmationId Get-VamtProduct Get-VamtProductKey Import-VamtData Initialize-VamtData Install-VamtConfirmationId Install-VamtProductActivation Install-VamtProductKey Update-VamtProduct",
                        nomarkup: "-ne -eq -lt -gt -ge -le -not -like -notlike -match -notmatch -contains -notcontains -in -notin -replace"
                    },
                    c: [t, e.NM, n, a, r, o, s]
                }
            });

        }
        $(document).ready(function () {
            function render_doc(doc_to_render, examples_mode) {
                
                $("#rendered h5").each(function (i, el) {
                    if ($(el).text().startsWith('-')) {
                        $(el).addClass('param')
                    }
                })
                $('#rendered table').addClass('table table-sm table-hover')
                if (examples_mode == 'new') {
                    $('#rendered code').addClass('powershell')
                }
                $('#rendered code').each(function (i, block) {
                    hljs.highlightBlock(block);
                })
                var authorcontent = $("td:contains('Author')").next('td').addClass('dbatools_author').text()
                $("#rendered .dbatools_author").html(Autolinker.link(authorcontent, {
                    className: 'myLink',
                    mention: 'twitter'
                })
                )
                $("#rendered h2#syntax").next().find('code').addClass('wrapped')
                if (ClipboardJS.isSupported()) {
                    $("#rendered h5[id^='example-']").append('<div class="bd-clipboard"><button class="btn-clipboard" title="Copy to clipboard">Copy</button></div>')
                    new ClipboardJS('.btn-clipboard', {
                        text: function (trigger) {
                            var textlines = $(trigger).parent().parent().next('pre').find('code').text().split('\n')
                            var copied = []
                            _.forEach(textlines, function (row) {
                                copied.push(row.replace(/^PS C:\\> /, "").replace(/^>>/, ""))
                            })
                            return _.join(copied, '\n')
                        }
                    });
                }


                //not all code is a block 
                $("#rendered h3[id*='-parameters']").nextAll().find('code').addClass('hljs-inline')
                $('#rendered #description').nextUntil('#rendered #syntax').find('code').addClass('hljs-inline')
            }

            $('#loader').removeClass('invisible')
            var index_url = 'assets/dbatools-index.json'
            var external_url = 'assets/external.json'
            var values = [];
            var options = {
                valueNames: ['CommandName', 'Description', 'Alias', 'Examples', 'Params'],
                item: '<a class="list-group-item" href="#"><span class="CommandName"></span></a>'
            }
            cmdlist = new List('cmdlist', options, values);
            var indexhelp = ''
            var allcmds = $.getJSON(index_url, function (data) {
                indexhelp = data
                cmdlist.add(data)
                var dbacommands = []
                var cloudlist = {}
                _.forEach(data, function (el) {
                    dbacommands.push(el.CommandName)
                    if (_.isArray(el.Tags)) {
                        _.forEach(el.Tags, function (el) {
                            if (!_.has(cloudlist, el)) {
                                cloudlist[el] = 0
                            }
                            cloudlist[el] += 1
                        })
                    } else if (!_.isUndefined(el.Tags)){
                        if (!_.has(cloudlist, el.Tags)) {
                            cloudlist[el.Tags] = 0
                        }
                        cloudlist[el.Tags] += 1
                    }
                })
                var weightedVals = []
                _.forEach(cloudlist, function (value, key) {
                    weightedVals.push({
                        text: key,
                        weight: value,
                        handlers: {
                            click: function () { $('#search-ft').val('tag:' + key).trigger('keyup') }
                        }
                    })
                })
                var pixelHeight = window.innerHeight * 0.65;
                $('#canvas').css({ 'height': pixelHeight + 'px' });
                $('#canvas').jQCloud(weightedVals, {
                    autoResize: true
                });

                register_dbatools_hljs(dbacommands.join(' '))
                $(window).trigger('hashchange');
            })
            var options2 = {
                valueNames: ['extName', { name: 'extHref', attr: 'href' }],
                item: '<div><a class="list-group-item list-group-item-secondary extHref" href="#" _target="_blank"><span class="extName"></span></a></div>'
            }
            extlist = new List('extlist', options2, [])

            $.getJSON(external_url, function (data) {
                $('#dbatools_version').text('(v ' + data.version + ')')
                _.forEach(data.external_links, function (el) {
                    extlist.add({ 'extName': el.name, 'extHref': el.href })
                })
            })
            cmdlist.on('searchComplete', function (e) {
                if (cmdlist.matchingItems.length === 0) {
                    var searchString = $('#search-ft').val().trim();
                    if (searchString.length > 0 && !searchString.startsWith("ft:")) {
                        if (searchString != "f" && searchString != "ft" && searchString != "ft:") {
                            $('#search-ft').val("ft:" + searchString)
                        }
                    }
                }
            })
            $('#cmdlist').on('click', 'a', function (e) {
                e.preventDefault();
                window.location.href = $(this).find('span.CommandName').text()
                /*
                window.location.hash = '#' + $(this).find('span.CommandName').text();
                $('#cmdlist').find('a.active').removeClass('active')
                $(this).addClass('active')
                */
            })
            $('#search-ft').on('keyup', function () {
                var searchString = $(this).val();
                if (searchString.trim() == "ft:" || searchString.trim() == "tag:") {
                    extlist.search();
                }
                else if (searchString.startsWith("ft:")) {
                    searchString = searchString.substring(3).trim();
                    cmdlist.search(searchString, ['CommandName', 'Alias', 'Description', 'Examples', 'Params']);
                } else if (searchString.startsWith("tag:")) {
                    searchString = searchString.substring(4).trim();
                    cmdlist.filter(function (item) {
                        if (_.indexOf(item.values().Tags, searchString) !== -1) {
                            return true;
                        } else {
                            return false;
                        }
                    });
                } else {
                    cmdlist.search(searchString, ['CommandName', 'Alias']);
                }
                extlist.search('$$$')
                if (_.isEmpty(searchString)) {
                    extlist.search()
                    cmdlist.filter()
                }
            })
            $('#clear-search').on('click', function () {
                $('#search-ft').val('').trigger('keyup')
            })
            $(window).on('hashchange', function (e) {
                var hash = window.location.hash.substr(1);
                var pagename = window.location.pathname.split("/").filter(function (c) { return c.length; }).pop();
                if (_.isUndefined(pagename)) {
                    pagename = ''
                } else {
                    pagename = pagename.split('.')[0];
                }
                if (hash.length == 0) {
                    hash = pagename
                }
                if (hash.length > 0) {
                    //ends with /
                    if (_.endsWith(hash, '/')) {
                        window.location.hash = '#' + hash.slice(0, hash.length - 1)
                        $(window).trigger('hashchange');
                        return;
                    }
                    //exact match
                    var topublish = _.findIndex(indexhelp, { 'Name': hash })
                    if (topublish == -1) {
                        //lowercase match
                        var topublish = _.findIndex(indexhelp, function (el) { return _.toLower(el.Name) == _.toLower(hash) })
                        if (topublish == -1) {
                            //alias match
                            var topublish = _.findIndex(indexhelp, { 'Alias': hash })
                            if (topublish == -1) {
                                //lowercase alias match
                                var topublish = _.findIndex(indexhelp, function (el) { return _.toLower(el.Alias) == _.toLower(hash) })
                            }
                            if (topublish == -1) {
                                //multiple aliases, optionally lowercased
                                var topublish = _.findIndex(indexhelp, function (el) { return _.includes(_.toLower(el.Alias).split(','), _.toLower(hash)) })
                            }
                        }
                        if (topublish !== -1) {
                            //normalization of URI
                            window.location.hash = '#' + indexhelp[topublish].CommandName
                            $(window).trigger('hashchange')
                            return;
                        }
                    }
                    if (topublish == -1) {
                        $('#rendered').html(marked('### 404 Function not found \n (while searching for ' + hash + '). Please visit dbatools.io/commands for an updated index of current commands.'));
                    } else {
                        var doc_to_render = indexhelp[topublish]
                        render_doc(doc_to_render, 'new')
                        $("body").data("doc_to_render", indexhelp[topublish])
                        if ($("#headscroll").offset().top > 150) {
                            $(window).scrollTo('#headscroll')
                        } else {
                            $(window).scrollTo(0, 800)
                        }
                    }
                } else {
                    $('#loader').addClass('invisible')
                }
            })
            $(window).scroll(function () {
                if ($(this).scrollTop() > 50) {
                    $('#back-to-top').fadeIn();
                } else {
                    $('#back-to-top').fadeOut();
                }
            })
            $('#back-to-top').click(function () {
                $(window).scrollTo(0, 800)
                return false;
            })

        })
    </script>
</head>


<body>

    <nav class="navbar navbar-expand-md customnav">
        <a href="https://docs.dbatools.io/" class="navbar-brand" rel="home" itemprop="url">
            <img width="265" height="64" src="https://dbatools.io/wp-content/uploads/2018/09/dbatools-docs.png"
                class="custom-logo" alt="dbatools" itemprop="logo" scale="0">
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse"
            aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
            <span class="oi oi-menu"></span>
        </button>
        <div class="collapse navbar-collapse flex-grow-1 text-right" id="navbarCollapse">
            <ul class="navbar-nav ml-auto flex-nowrap">
                <li class="nav-item">
                    <a class="nav-link" href="https://dbatools.io/download/">download</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://dbatools.io/getting-started/">get started</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://dbatools.io/functions/">commands</a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="#">docs</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://dbatools.io/team/">team</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://dbatools.io/subscribe/">subscribe</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://dbatools.io/slack">find us</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://dbatools.io/builds">build reference</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://dbatools.io/boh">bill of health</a>
                </li>
            </ul>
            <div class="p-2 flex-shrink-0 bd-highlight invisible">cl said "add this much | |"</div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <hr />
            </div>
        </div>
        <div class="row">
            <div class="col-xl-3 col-lg-5 col-md-5 col-sm-12 bd-sidebar">
                <div id="relcommands" class="">
                    <h3>
                        commands
                        <small id="dbatools_version" class="text-muted"></small>
                    </h3>
                    <p></p>
                    <div class="form-group row">
                        <div class="col-lg-12">
                            <div class="input-group">

                                <input type="text" class="form-control" id="search-ft"
                                    placeholder="Search (&quot;ft: term&quot; enables fulltext)" autocomplete="off">
                                <div class="input-group-append">
                                    <div class="input-group-text" id="clear-search">Clear</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="extlist">
                        <div class="list list-group"></div>
                    </div>
                    <div id="cmdlist">
                        <div class="list list-group"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-9 col-lg-7 col-md-7 col-sm-12 bd-content">
                <div id="headscroll">
                    <a id="back-to-top" href="#" class="btn btn-primary btn-lg back-to-top" role="button"
                        title="Click to return on the top page">&#94;</a>
                </div>
                <div id="rendered">
                    <h1 id="update-dbainstance">Update-DbaInstance</h1>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Author</strong></td>
<td>Kirill Kravtsov (@nvarscar) <a href="https://nvarscar.wordpress.com/">https://nvarscar.wordpress.com/</a></td>
</tr>
<tr>
<td><strong>Availability</strong></td>
<td>Windows only</td>
</tr>
</tbody>
</table>
<p> </p>
<h2 id="synopsis">Synopsis</h2>
<p>Invokes installation of SQL Server Service Packs and Cumulative Updates on local and remote servers.</p>
<h2 id="description">Description</h2>
<p>Starts and automated process of updating SQL Server installation to a specific version defined in the parameters.
The command will:</p>
<ul>
<li>Search for SQL Server installations in a remote registry</li>
<li>Check if current settings are applicable to the current SQL Server versions</li>
<li>Search for a KB executable in a folder specified in -Path</li>
<li>Establish a PSRemote connection to the target machine if necessary</li>
<li>Extract KB to a temporary folder in a current user's profile</li>
<li>Run the installation from the temporary folder updating all instances on the computer at once</li>
<li>Remove temporary files</li>
<li>Restart the computer (if -Restart is specified)</li>
<li>Repeat for each consequent KB and computer</li>
</ul>
<p>The impact of this function is set to High, if you don't want to receive interactive prompts, set -Confirm to $false.
Credentials are a required parameter for remote machines. Without specifying -Credential, the installation will fail due to lack of permissions.</p>
<p>CredSSP is a recommended transport for running the updates remotely. Update-DbaInstance will attempt to reconfigure
local and remote hosts to support CredSSP, which is why it is desirable to run this command in an elevated console at all times.
CVE-2018-0886 security update is required for both local and remote hosts. If CredSSP connections are failing, make sure to
apply recent security updates prior to doing anything else.</p>
<p>When using CredSSP authentication, this function will configure CredSSP authentication for PowerShell Remoting sessions.
If this is not desired (e.g.: CredSSP authentication is managed externally, or is already configured appropriately,)
it can be disabled by setting the dbatools configuration option 'commands.initialize-credssp.bypass' value to $true.</p>
<p>Always backup databases and configurations prior to upgrade.</p>
<h2 id="syntax">Syntax</h2>
<pre><code>Update-DbaInstance
    [[-ComputerName] &lt;DbaInstanceParameter[]&gt;]
    [-Credential &lt;PSCredential&gt;]
    [-Version &lt;String[]&gt;]
    [-Type &lt;String[]&gt;]
    [-InstanceName &lt;String&gt;]
    [-Path &lt;String[]&gt;]
    [-Restart]
    [-Continue]
    [-Throttle &lt;Int32&gt;]
    [-Authentication &lt;String&gt;]
    [-ExtractPath &lt;String&gt;]
    [-ArgumentList &lt;String[]&gt;]
    [-Download]
    [-EnableException]
    [-WhatIf]
    [-Confirm]
    [&lt;CommonParameters&gt;]

Update-DbaInstance
    [[-ComputerName] &lt;DbaInstanceParameter[]&gt;]
    [-Credential &lt;PSCredential&gt;] -KB &lt;String[]&gt;
    [-InstanceName &lt;String&gt;]
    [-Path &lt;String[]&gt;]
    [-Restart]
    [-Continue]
    [-Throttle &lt;Int32&gt;]
    [-Authentication &lt;String&gt;]
    [-ExtractPath &lt;String&gt;]
    [-ArgumentList &lt;String[]&gt;]
    [-Download]
    [-EnableException]
    [-WhatIf]
    [-Confirm]
    [&lt;CommonParameters&gt;]

</code></pre>
<p> </p>
<h2 id="examples">Examples</h2>
<p> </p>
<h5 id="example-1">Example:  1</h5>
<pre><code>PS C:\&gt; Update-DbaInstance -ComputerName SQL1 -Version SP3 -Path \\network\share
</code></pre>
<p>Updates all applicable SQL Server installations on SQL1 to SP3.<br>
Binary files for the update will be searched among all files and folders recursively in \network\share.<br>
Prompts for confirmation before the update.<br></p>
<h5 id="example-2">Example:  2</h5>
<pre><code>PS C:\&gt; Update-DbaInstance -ComputerName SQL1, SQL2 -Restart -Path \\network\share -Confirm:$false
</code></pre>
<p>Updates all applicable SQL Server installations on SQL1 and SQL2 with the most recent patch.<br>
It will install latest ServicePack, restart the computers, install latest Cumulative Update, and finally restart the computer once again.<br>
Binary files for the update will be searched among all files and folders recursively in \network\share.<br>
Does not prompt for confirmation.<br></p>
<h5 id="example-3">Example:  3</h5>
<pre><code>PS C:\&gt; Update-DbaInstance -ComputerName SQL1 -Version 2012 -Type ServicePack -Path \\network\share
</code></pre>
<p>Updates SQL Server 2012 on SQL1 with the most recent ServicePack found in your patch repository.<br>
Binary files for the update will be searched among all files and folders recursively in \network\share.<br>
Prompts for confirmation before the update.<br></p>
<h5 id="example-4">Example:  4</h5>
<pre><code>PS C:\&gt; Update-DbaInstance -ComputerName SQL1 -KB 123456 -Restart -Path \\network\share -Confirm:$false
</code></pre>
<p>Installs KB 123456 on SQL1 and restarts the computer.<br>
Binary files for the update will be searched among all files and folders recursively in \network\share.<br>
Does not prompt for confirmation.<br></p>
<h5 id="example-5">Example:  5</h5>
<pre><code>PS C:\&gt; Update-DbaInstance -ComputerName Server1 -Version SQL2012SP3, SQL2016SP2CU3 -Path \\network\share -Restart -Confirm:$false
</code></pre>
<p>Updates SQL 2012 to SP3 and SQL 2016 to SP2CU3 on Server1. Each update will be followed by a restart.<br>
Binary files for the update will be searched among all files and folders recursively in \network\share.<br>
Does not prompt for confirmation.<br></p>
<h5 id="example-6">Example:  6</h5>
<pre><code>PS C:\&gt; Update-DbaInstance -ComputerName Server1 -Path \\network\share -Restart -Confirm:$false -ExtractPath &quot;C:\temp&quot;
</code></pre>
<p>Updates all applicable SQL Server installations on Server1 with the most recent patch. Each update will be followed by a restart.<br>
Binary files for the update will be searched among all files and folders recursively in \network\share.<br>
Does not prompt for confirmation.<br>
Extracts the files in local driver on Server1 C:\temp.<br></p>
<h5 id="example-7">Example:  7</h5>
<pre><code>PS C:\&gt; Update-DbaInstance -ComputerName Server1 -Path \\network\share -ArgumentList &quot;/SkipRules=RebootRequiredCheck&quot;
</code></pre>
<p>Updates all applicable SQL Server installations on Server1 with the most recent patch.<br>
Additional command line parameters would be passed to the executable.<br>
Binary files for the update will be searched among all files and folders recursively in \network\share.<br></p>
<h5 id="example-8">Example:  8</h5>
<pre><code>PS C:\&gt; Update-DbaInstance -ComputerName SQL1 -Version CU3 -Download -Path \\network\share -Confirm:$false
</code></pre>
<p>Downloads an appropriate CU KB to \network\share and installs it onto SQL1.<br>
Does not prompt for confirmation.<br></p>
<h3 id="required-parameters">Required Parameters</h3>
<h5 id="kb">-KB</h5>
<p>Install a specific update or list of updates. Can be a number of a string KBXXXXXXX.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>True</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="optional-parameters">Optional Parameters</h3>
<h5 id="computername">-ComputerName</h5>
<p>Target computer with SQL instance or instances.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td>cn,host,Server</td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>true (ByValue)</td>
</tr>
<tr>
<td>Default Value</td>
<td>$env:COMPUTERNAME</td>
</tr>
</tbody>
</table>
<h5 id="credential">-Credential</h5>
<p>Windows Credential with permission to log on to the remote server.
Must be specified for any remote connection if update Repository is located on a network folder.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="version">-Version</h5>
<p>A target version of the installation you want to reach. If not specified, a latest available version would be used by default.
Can be defined using the following general pattern: <MajorVersion><SPX><CUX>.
Any part of the pattern can be omitted if needed:
2008R2SP1 - will update SQL 2008R2 to SP1
2016CU3 - will update SQL 2016 to CU3 of current Service Pack installed
SP0CU3 - will update all existing SQL Server versions to RTM CU3 without installing any service packs
SP1CU7 - will update all existing SQL Server versions to SP1 and then (after restart if -Restart is specified) to SP1CU7
CU7 - will update all existing SQL Server versions to CU7 of current Service Pack installed<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="type">-Type</h5>
<p>Type of the update: All | ServicePack | CumulativeUpdate.
Default: All
Use -Version to limit upgrade to a certain Major version of SQL Server.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>@('All')</td>
</tr>
<tr>
<td>Accepted Values</td>
<td>All,ServicePack,CumulativeUpdate</td>
</tr>
</tbody>
</table>
<h5 id="instancename">-InstanceName</h5>
<p>Only updates a specific instance(s).<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td>Instance</td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="path">-Path</h5>
<p>Path to the folder(s) with SQL Server patches downloaded. It will be scanned recursively for available patches.
Path should be available from both server with SQL Server installation and client that runs the command.
All file names should match the pattern used by Microsoft: SQLServer####<em>-KB###-</em>x##*.exe
If a file is missing in the repository, the installation will fail.
Consider setting the following configuration if you want to omit this parameter: <code>Set-DbatoolsConfig -Name Path.SQLServerUpdates -Value '\\path\to\updates'</code><br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>(Get-DbatoolsConfigValue -Name 'Path.SQLServerUpdates')</td>
</tr>
</tbody>
</table>
<h5 id="restart">-Restart</h5>
<p>Restart computer automatically after a successful installation of a patch and wait until it comes back online.
Using this parameter is the only way to chain-install more than 1 patch on a computer, since every single patch will require a restart of said computer.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>False</td>
</tr>
</tbody>
</table>
<h5 id="continue">-Continue</h5>
<p>Continues a failed installation attempt when specified. Will abort a previously failed installation otherwise.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>False</td>
</tr>
</tbody>
</table>
<h5 id="throttle">-Throttle</h5>
<p>Maximum number of computers updated in parallel. Once reached, the update operations will queue up.
Default: 50<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>50</td>
</tr>
</tbody>
</table>
<h5 id="authentication">-Authentication</h5>
<p>Chooses an authentication protocol for remote connections.
If the protocol fails to establish a connection
Defaults:</p>
<ul>
<li>CredSSP when -Credential is specified - due to the fact that repository Path is usually a network share and credentials need to be passed to the remote host to avoid the double-hop issue.</li>
<li>Default when -Credential is not specified. Will likely fail if a network path is specified.<br></li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>@('CredSSP', 'Default')[$null -eq $Credential]</td>
</tr>
<tr>
<td>Accepted Values</td>
<td>Default,Basic,Negotiate,NegotiateWithImplicitCredential,Credssp,Digest,Kerberos</td>
</tr>
</tbody>
</table>
<h5 id="extractpath">-ExtractPath</h5>
<p>Lets you specify a location to extract the update file to on the system requiring the update. e.g. C:\temp<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="argumentlist">-ArgumentList</h5>
<p>A list of extra arguments to pass to the execution file. Accepts one or more strings containing command line parameters.
Example: ... -ArgumentList &quot;/SkipRules=RebootRequiredCheck&quot;, &quot;/Q&quot;<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="download">-Download</h5>
<p>Download missing KBs to the first folder specified in the -Path parameter.
Files would be first downloaded to the local machine (TEMP folder), and then distributed onto remote machines if needed.
If the Path is a network Path, the files would be downloaded straight to the network folder and executed from there.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>False</td>
</tr>
</tbody>
</table>
<h5 id="enableexception">-EnableException</h5>
<p>By default, when something goes wrong we try to catch it, interpret it and give you a friendly warning message.
This avoids overwhelming you with &quot;sea of red&quot; exceptions, but is inconvenient because it basically disables advanced scripting.
Using this switch turns this &quot;nice by default&quot; feature off and enables you to catch exceptions with your own try/catch.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>False</td>
</tr>
</tbody>
</table>
<h5 id="whatif">-WhatIf</h5>
<p>Shows what would happen if the command were to run. No actions are actually performed.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td>wi</td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="confirm">-Confirm</h5>
<p>Prompts you for confirmation before executing any changing operations within the command.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td>cf</td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<p> </p>
<p>Want to see the source code for this command? Check out <a href="https://github.com/sqlcollaborative/dbatools/blob/master/functions/Update-DbaInstance.ps1">Update-DbaInstance</a> on GitHub.
<br>
Want to see the Bill Of Health for this command? Check out <a href="https://sqlcollaborative.github.io/boh#Update-DbaInstance">Update-DbaInstance</a>.</p>

                </div> <!-- rendered -->
            </div>
        </div>
    </div>
</body>

</html>
