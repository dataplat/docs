<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>dbatools docs | Update-DbaInstance</title>
    <link rel="icon" href="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png" sizes="32x32">
    <link rel="icon" href="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png" sizes="192x192">
    <link rel="apple-touch-icon-precomposed" href="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png">
    <meta name="msapplication-TileImage" content="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png">

    <link title="Search" rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml">
    <meta name="keywords" content="dbatools, ,powershell,sql server,devops,json">
    <meta name="subtitle" content="Docs for Update-DbaInstance">
    <meta property="og:type" content="article" />
    <meta property="og:title" content="dbatools docs:  Update-DbaInstance" />
    <meta property="og:url" content="https://docs.dbatools.io/Update-DbaInstance.html" />
    <meta property="og:description" content="dbatools docs for Update-DbaInstance" />
    <meta property="og:site_name" content="docs.dbatools.io" />
    <meta property="og:locale" content="en_US" />
    <meta name="twitter:text:title" content="dbatools docs:  Update-DbaInstance" />
    
    <meta name="twitter:image" content="https://docs.dbatools.io/assets/thumbs/Update-DbaInstance.png">
    <meta name="twitter:card" content="summary_large_image">
    
    <meta name=twitter:creator content="@psdbatools">
    <meta name=twitter:title content="dbatools docs:  Update-DbaInstance">
    <meta property="twitter:site" content="@psdbatools" />

    <meta property="og:image" content="https://docs.dbatools.io/assets/thumbs/Update-DbaInstance.png">
    <link rel=canonical href="https://docs.dbatools.io/Update-DbaInstance.html" />
    <link rel=alternate type=application/json
        href=https://raw.githubusercontent.com/dataplat/dbatools/master/bin/dbatools-index.json
        title="dbatools documentation">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css"
        href="//cdnjs.cloudflare.com/ajax/libs/open-iconic/1.1.1/font/css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" type="text/css"
        href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

    <link rel="stylesheet" href="assets/css/layout.css">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-80639740-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-80639740-2');
    </script>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
    <script src="//cdn.jsdelivr.net/npm/lodash@4.17.4/lodash.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="//cdn.jsdelivr.net/jquery.scrollto/2.1.2/jquery.scrollTo.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/autolinker/1.7.1/Autolinker.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jqcloud2@2.0.3/dist/jqcloud.min.js"
        integrity="sha256-+krhsKJpvd3AZYVGHcwyCUGO01uNdGSTvqR7Apcy30E=" crossorigin="anonymous"></script>

    <script type="text/javascript" language="javascript">
        function register_dbatools_hljs(dbatoolscommands) {

            hljs.registerLanguage("powershell", function (e) {
                var t = {
                    b: "`[\\s\\S]",
                    r: 0
                },
                    o = {
                        cN: "variable",
                        v: [{
                            b: /\$[\w\d][\w\d_:]*/
                        }]
                    },
                    r = {
                        cN: "literal",
                        b: /\$(null|true|false)\b/
                    },
                    n = {
                        cN: "string",
                        v: [{
                            b: /"/,
                            e: /"/
                        }, {
                            b: /@"/,
                            e: /^"@/
                        }],
                        c: [t, o, {
                            cN: "variable",
                            b: /\$[A-z]/,
                            e: /[^A-z]/
                        }]
                    },
                    a = {
                        cN: "string",
                        v: [{
                            b: /'/,
                            e: /'/
                        }, {
                            b: /@'/,
                            e: /^'@/
                        }]
                    },
                    i = {
                        cN: "doctag",
                        v: [{
                            b: /\.(synopsis|description|example|inputs|outputs|notes|link|component|role|functionality)/
                        }, {
                            b: /\.(parameter|forwardhelptargetname|forwardhelpcategory|remotehelprunspace|externalhelp)\s+\S+/
                        }]
                    },
                    s = e.inherit(e.C(null, null), {
                        v: [{
                            b: /#/,
                            e: /$/
                        }, {
                            b: /<#/,
                            e: /#>/
                        }],
                        c: [i]
                    });
                return {
                    aliases: ["ps"],
                    l: /-?[A-z\.\-]+/,
                    cI: !0,
                    k: {
                        keyword: "if else foreach return function do while until elseif begin for trap data dynamicparam end break throw param continue finally in switch exit filter try process catch",
                        built_in: dbatoolscommands + " Add-Computer Add-Content Add-History Add-JobTrigger Add-Member Add-PSSnapin Add-Type Checkpoint-Computer Clear-Content Clear-EventLog Clear-History Clear-Host Clear-Item Clear-ItemProperty Clear-Variable Compare-Object Complete-Transaction Connect-PSSession Connect-WSMan Convert-Path ConvertFrom-Csv ConvertFrom-Json ConvertFrom-SecureString ConvertFrom-StringData ConvertTo-Csv ConvertTo-Html ConvertTo-Json ConvertTo-SecureString ConvertTo-Xml Copy-Item Copy-ItemProperty Debug-Process Disable-ComputerRestore Disable-JobTrigger Disable-PSBreakpoint Disable-PSRemoting Disable-PSSessionConfiguration Disable-WSManCredSSP Disconnect-PSSession Disconnect-WSMan Disable-ScheduledJob Enable-ComputerRestore Enable-JobTrigger Enable-PSBreakpoint Enable-PSRemoting Enable-PSSessionConfiguration Enable-ScheduledJob Enable-WSManCredSSP Enter-PSSession Exit-PSSession Export-Alias Export-Clixml Export-Console Export-Counter Export-Csv Export-FormatData Export-ModuleMember Export-PSSession ForEach-Object Format-Custom Format-List Format-Table Format-Wide Get-Acl Get-Alias Get-AuthenticodeSignature Get-ChildItem Get-Command Get-ComputerRestorePoint Get-Content Get-ControlPanelItem Get-Counter Get-Credential Get-Culture Get-Date Get-Event Get-EventLog Get-EventSubscriber Get-ExecutionPolicy Get-FormatData Get-Host Get-HotFix Get-Help Get-History Get-IseSnippet Get-Item Get-ItemProperty Get-Job Get-JobTrigger Get-Location Get-Member Get-Module Get-PfxCertificate Get-Process Get-PSBreakpoint Get-PSCallStack Get-PSDrive Get-PSProvider Get-PSSession Get-PSSessionConfiguration Get-PSSnapin Get-Random Get-ScheduledJob Get-ScheduledJobOption Get-Service Get-TraceSource Get-Transaction Get-TypeData Get-UICulture Get-Unique Get-Variable Get-Verb Get-WinEvent Get-WmiObject Get-WSManCredSSP Get-WSManInstance Group-Object Import-Alias Import-Clixml Import-Counter Import-Csv Import-IseSnippet Import-LocalizedData Import-PSSession Import-Module Invoke-AsWorkflow Invoke-Command Invoke-Expression Invoke-History Invoke-Item Invoke-RestMethod Invoke-WebRequest Invoke-WmiMethod Invoke-WSManAction Join-Path Limit-EventLog Measure-Command Measure-Object Move-Item Move-ItemProperty New-Alias New-Event New-EventLog New-IseSnippet New-Item New-ItemProperty New-JobTrigger New-Object New-Module New-ModuleManifest New-PSDrive New-PSSession New-PSSessionConfigurationFile New-PSSessionOption New-PSTransportOption New-PSWorkflowExecutionOption New-PSWorkflowSession New-ScheduledJobOption New-Service New-TimeSpan New-Variable New-WebServiceProxy New-WinEvent New-WSManInstance New-WSManSessionOption Out-Default Out-File Out-GridView Out-Host Out-Null Out-Printer Out-String Pop-Location Push-Location Read-Host Receive-Job Register-EngineEvent Register-ObjectEvent Register-PSSessionConfiguration Register-ScheduledJob Register-WmiEvent Remove-Computer Remove-Event Remove-EventLog Remove-Item Remove-ItemProperty Remove-Job Remove-JobTrigger Remove-Module Remove-PSBreakpoint Remove-PSDrive Remove-PSSession Remove-PSSnapin Remove-TypeData Remove-Variable Remove-WmiObject Remove-WSManInstance Rename-Computer Rename-Item Rename-ItemProperty Reset-ComputerMachinePassword Resolve-Path Restart-Computer Restart-Service Restore-Computer Resume-Job Resume-Service Save-Help Select-Object Select-String Select-Xml Send-MailMessage Set-Acl Set-Alias Set-AuthenticodeSignature Set-Content Set-Date Set-ExecutionPolicy Set-Item Set-ItemProperty Set-JobTrigger Set-Location Set-PSBreakpoint Set-PSDebug Set-PSSessionConfiguration Set-ScheduledJob Set-ScheduledJobOption Set-Service Set-StrictMode Set-TraceSource Set-Variable Set-WmiInstance Set-WSManInstance Set-WSManQuickConfig Show-Command Show-ControlPanelItem Show-EventLog Sort-Object Split-Path Start-Job Start-Process Start-Service Start-Sleep Start-Transaction Start-Transcript Stop-Computer Stop-Job Stop-Process Stop-Service Stop-Transcript Suspend-Job Suspend-Service Tee-Object Test-ComputerSecureChannel Test-Connection Test-ModuleManifest Test-Path Test-PSSessionConfigurationFile Trace-Command Unblock-File Undo-Transaction Unregister-Event Unregister-PSSessionConfiguration Unregister-ScheduledJob Update-FormatData Update-Help Update-List Update-TypeData Use-Transaction Wait-Event Wait-Job Wait-Process Where-Object Write-Debug Write-Error Write-EventLog Write-Host Write-Output Write-Progress Write-Verbose Write-Warning Add-MDTPersistentDrive Disable-MDTMonitorService Enable-MDTMonitorService Get-MDTDeploymentShareStatistics Get-MDTMonitorData Get-MDTOperatingSystemCatalog Get-MDTPersistentDrive Import-MDTApplication Import-MDTDriver Import-MDTOperatingSystem Import-MDTPackage Import-MDTTaskSequence New-MDTDatabase Remove-MDTMonitorData Remove-MDTPersistentDrive Restore-MDTPersistentDrive Set-MDTMonitorData Test-MDTDeploymentShare Test-MDTMonitorData Update-MDTDatabaseSchema Update-MDTDeploymentShare Update-MDTLinkedDS Update-MDTMedia Update-MDTMedia Add-VamtProductKey Export-VamtData Find-VamtManagedMachine Get-VamtConfirmationId Get-VamtProduct Get-VamtProductKey Import-VamtData Initialize-VamtData Install-VamtConfirmationId Install-VamtProductActivation Install-VamtProductKey Update-VamtProduct",
                        nomarkup: "-ne -eq -lt -gt -ge -le -not -like -notlike -match -notmatch -contains -notcontains -in -notin -replace"
                    },
                    c: [t, e.NM, n, a, r, o, s]
                }
            });

        }
        $(document).ready(function () {
            function render_doc(doc_to_render, examples_mode) {
                
                $("#rendered h5").each(function (i, el) {
                    if ($(el).text().startsWith('-')) {
                        $(el).addClass('param')
                    }
                })
                $('#rendered table').addClass('table table-sm table-hover')
                if (examples_mode == 'new') {
                    $('#rendered code').addClass('powershell')
                }
                $('#rendered code').each(function (i, block) {
                    hljs.highlightBlock(block);
                })
                var authorcontent = $("td:contains('Author')").next('td').addClass('dbatools_author').text()
                $("#rendered .dbatools_author").html(Autolinker.link(authorcontent, {
                    className: 'myLink',
                    mention: 'twitter'
                })
                )
                $("#rendered h2#syntax").next().find('code').addClass('wrapped')
                if (ClipboardJS.isSupported()) {
                    $("#rendered h5[id^='example-']").append('<div class="bd-clipboard"><button class="btn-clipboard" title="Copy to clipboard">Copy</button></div>')
                    new ClipboardJS('.btn-clipboard', {
                        text: function (trigger) {
                            var textlines = $(trigger).parent().parent().next('pre').find('code').text().split('\n')
                            var copied = []
                            _.forEach(textlines, function (row) {
                                copied.push(row.replace(/^PS C:\\> /, "").replace(/^>>/, ""))
                            })
                            return _.join(copied, '\n')
                        }
                    });
                }


                //not all code is a block 
                $("#rendered h3[id*='-parameters']").nextAll().find('code').addClass('hljs-inline')
                $('#rendered #description').nextUntil('#rendered #syntax').find('code').addClass('hljs-inline')
            }

            $('#loader').removeClass('invisible')
            var index_url = 'assets/dbatools-index.json'
            var external_url = 'assets/external.json'
            var values = [];
            var options = {
                valueNames: ['CommandName', 'Description', 'Alias', 'Examples', 'Params'],
                item: '<a class="list-group-item" href="#"><span class="CommandName"></span></a>'
            }
            cmdlist = new List('cmdlist', options, values);
            var indexhelp = ''
            var allcmds = $.getJSON(index_url, function (data) {
                indexhelp = data
                cmdlist.add(data)
                var dbacommands = []
                var cloudlist = {}
                _.forEach(data, function (el) {
                    dbacommands.push(el.CommandName)
                    if (_.isArray(el.Tags)) {
                        _.forEach(el.Tags, function (el) {
                            if (!_.has(cloudlist, el)) {
                                cloudlist[el] = 0
                            }
                            cloudlist[el] += 1
                        })
                    } else if (!_.isUndefined(el.Tags)){
                        if (!_.has(cloudlist, el.Tags)) {
                            cloudlist[el.Tags] = 0
                        }
                        cloudlist[el.Tags] += 1
                    }
                })
                var weightedVals = []
                _.forEach(cloudlist, function (value, key) {
                    weightedVals.push({
                        text: key,
                        weight: value,
                        handlers: {
                            click: function () { $('#search-ft').val('tag:' + key).trigger('keyup') }
                        }
                    })
                })
                var pixelHeight = window.innerHeight * 0.65;
                $('#canvas').css({ 'height': pixelHeight + 'px' });
                $('#canvas').jQCloud(weightedVals, {
                    autoResize: true
                });

                register_dbatools_hljs(dbacommands.join(' '))
                $(window).trigger('hashchange');
            })
            var options2 = {
                valueNames: ['extName', { name: 'extHref', attr: 'href' }],
                item: '<div><a class="list-group-item list-group-item-secondary extHref" href="#" _target="_blank"><span class="extName"></span></a></div>'
            }
            extlist = new List('extlist', options2, [])

            $.getJSON(external_url, function (data) {
                $('#dbatools_version').text('(v ' + data.version + ')')
                _.forEach(data.external_links, function (el) {
                    extlist.add({ 'extName': el.name, 'extHref': el.href })
                })
            })
            cmdlist.on('searchComplete', function (e) {
                if (cmdlist.matchingItems.length === 0) {
                    var searchString = $('#search-ft').val().trim();
                    if (searchString.length > 0 && !searchString.startsWith("ft:")) {
                        if (searchString != "f" && searchString != "ft" && searchString != "ft:") {
                            $('#search-ft').val("ft:" + searchString)
                        }
                    }
                }
            })
            $(document).on('mouseenter', '#cmdlist', function (e) {
                $('#search-ft').blur();
            })
            cmdlist.on('updated', function() {
                $('#cmdlist a').each(function(i, el) {
                    $(el).attr('href', $(el).find('span.CommandName').text())
                })
            })
            $('#cmdlist').on('mouseenter', 'a', function (e) {
                $(this).attr('href', $(this).find('span.CommandName').text());
                /*
                e.preventDefault();
                window.location.href = $(this).find('span.CommandName').text()
                ---
                window.location.hash = '#' + $(this).find('span.CommandName').text();
                $('#cmdlist').find('a.active').removeClass('active')
                $(this).addClass('active')
                */
            })
            $('#search-ft').bind('change keyup', function () {
                var searchString = $(this).val();
                if (searchString.trim() == "ft:" || searchString.trim() == "tag:") {
                    extlist.search();
                }
                else if (searchString.startsWith("ft:")) {
                    searchString = searchString.substring(3).trim();
                    if (cmdlist.filtered) {
                        cmdlist.filter();
                    }
                    cmdlist.search(searchString, ['CommandName', 'Alias', 'Description', 'Synopsis', 'Examples', 'Params']);
                } else if (searchString.startsWith("tag:")) {
                    searchString = searchString.substring(4).trim();
                    if (cmdlist.searched) {
                        cmdlist.search();
                    }
                    cmdlist.filter(function (item) {
                        if (_.indexOf(item.values().Tags, searchString) !== -1) {
                            return true;
                        } else {
                            return false;
                        }
                    });
                } else {
                    if (cmdlist.filtered) {
                        cmdlist.filter();
                    }
                    cmdlist.search(searchString, ['CommandName', 'Alias']);
                }
                extlist.search('$$$')
                if (_.isEmpty(searchString)) {
                    extlist.search()
                    cmdlist.filter()
                }
            })
            $('#clear-search').on('click', function () {
                $('#search-ft').val('').trigger('keyup')
            })
            $(window).on('hashchange', function (e) {
                var hash = window.location.hash.substr(1);
                var pagename = window.location.pathname.split("/").filter(function (c) { return c.length; }).pop();
                if (_.isUndefined(pagename)) {
                    pagename = ''
                } else {
                    pagename = pagename.split('.')[0];
                }
                if (hash.length == 0) {
                    hash = pagename
                }
                if (hash.length > 0) {
                    //ends with /
                    if (_.endsWith(hash, '/')) {
                        window.location.hash = '#' + hash.slice(0, hash.length - 1)
                        $(window).trigger('hashchange');
                        return;
                    }
                    //exact match
                    var topublish = _.findIndex(indexhelp, { 'Name': hash })
                    if (topublish == -1) {
                        //lowercase match
                        var topublish = _.findIndex(indexhelp, function (el) { return _.toLower(el.Name) == _.toLower(hash) })
                        if (topublish == -1) {
                            //alias match
                            var topublish = _.findIndex(indexhelp, { 'Alias': hash })
                            if (topublish == -1) {
                                //lowercase alias match
                                var topublish = _.findIndex(indexhelp, function (el) { return _.toLower(el.Alias) == _.toLower(hash) })
                            }
                            if (topublish == -1) {
                                //multiple aliases, optionally lowercased
                                var topublish = _.findIndex(indexhelp, function (el) { return _.includes(_.toLower(el.Alias).split(','), _.toLower(hash)) })
                            }
                        }
                        if (topublish !== -1) {
                            //normalization of URI
                            window.location.hash = '#' + indexhelp[topublish].CommandName
                            $(window).trigger('hashchange')
                            return;
                        }
                    }
                    if (topublish == -1) {
                        $('#rendered').html(marked.parse('### 404 Function not found \n (while searching for ' + hash + '). Please visit dbatools.io/commands for an updated index of current commands.'));
                    } else {
                        var doc_to_render = indexhelp[topublish]
                        render_doc(doc_to_render, 'new')
                        $("body").data("doc_to_render", indexhelp[topublish])
                        if ($("#headscroll").offset().top > 150) {
                            $(window).scrollTo('#headscroll')
                        } else {
                            $(window).scrollTo(0, 800)
                        }
                    }
                } else {
                    $('#loader').addClass('invisible')
                }
            })
            $(window).scroll(function () {
                if ($(this).scrollTop() > 50) {
                    $('#back-to-top').fadeIn();
                } else {
                    $('#back-to-top').fadeOut();
                }
            })
            $('#back-to-top').click(function () {
                $(window).scrollTo(0, 800)
                return false;
            })

        })
    </script>
</head>


<body>

    <nav class="navbar navbar-expand-md customnav">
        <a href="https://docs.dbatools.io/" class="navbar-brand" rel="home" itemprop="url">
            <img width="265" height="64" src="https://dbatools.io/wp-content/uploads/2018/09/dbatools-docs.png"
                class="custom-logo" alt="dbatools" itemprop="logo" scale="0">
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse"
            aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
            <span class="oi oi-menu"></span>
        </button>
        <div class="collapse navbar-collapse flex-grow-1 text-right" id="navbarCollapse">
            <ul class="navbar-nav ml-auto flex-nowrap">
                <li class="nav-item">
                    <a class="nav-link" style="color:#293E5D" href="https://dbatools.io/download/">⬇ download</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" style="color:#293E5D" href="https://dbatools.io/commands/">🚀 commands</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" style="color:#293E5D" href="https://dbatools.io/slack">🔍 find us</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" style="color:#293E5D" href="https://dbatools.io/builds">🔢 build ref</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" style="color:#293E5D" href="https://dbatools.io/book">📘 dbatools book</a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <hr />
            </div>
        </div>
        <div class="row">
            <div class="col-xl-3 col-lg-5 col-md-5 col-sm-12 bd-sidebar">
                <div id="relcommands" class="">
                    <h3>
                        commands
                        <small id="dbatools_version" class="text-muted"></small>
                    </h3>
                    <p></p>
                    <div class="form-group row">
                        <div class="col-lg-12">
                            <div class="input-group">

                                <input type="text" class="form-control" id="search-ft"
                                    placeholder="Search (&quot;ft: term&quot; enables fulltext)" autocomplete="off">
                                <div class="input-group-append">
                                    <div class="input-group-text" id="clear-search">Clear</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="extlist">
                        <div class="list list-group"></div>
                    </div>
                    <div id="cmdlist">
                        <div class="list list-group"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-9 col-lg-7 col-md-7 col-sm-12 bd-content">
                <div id="headscroll">
                    <a id="back-to-top" href="#" class="btn btn-primary btn-lg back-to-top" role="button"
                        title="Click to return on the top page">&#94;</a>
                </div>
                <div id="rendered">
                    <h1 id="update-dbainstance">Update-DbaInstance</h1>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Author</strong></td>
<td>Kirill Kravtsov (@nvarscar), nvarscar.wordpress.com</td>
</tr>
<tr>
<td><strong>Availability</strong></td>
<td>Windows, Linux, macOS</td>
</tr>
</tbody>
</table>
<p> </p>
<p>Want to see the source code for this command? Check out <a href="https://github.com/dataplat/dbatools/blob/master/public/Update-DbaInstance.ps1">Update-DbaInstance</a> on GitHub.
<br>
Want to see the Bill Of Health for this command? Check out <a href="https://dataplat.github.io/boh#Update-DbaInstance">Update-DbaInstance</a>.</p>
<h2 id="synopsis">Synopsis</h2>
<p>Installs SQL Server Service Packs and Cumulative Updates across local and remote instances automatically.</p>
<h2 id="description">Description</h2>
<p>Automates the complete process of applying SQL Server patches to eliminate the manual effort of updating multiple instances. This function handles the entire patching workflow from detection through installation, replacing the tedious process of manually downloading, transferring, and applying updates across your SQL Server environment.</p>
<p>The patching process includes:</p>
<ul>
<li>Discovering all SQL Server instances on target computers via registry scanning</li>
<li>Validating current versions against target update requirements</li>
<li>Locating appropriate KB installers in your patch repository</li>
<li>Establishing secure remote connections using CredSSP or other protocols</li>
<li>Extracting and executing patches from temporary directories</li>
<li>Managing restarts and chaining multiple updates when needed</li>
<li>Cleaning up temporary files after installation</li>
<li>Processing multiple computers in parallel for faster deployment</li>
</ul>
<p>This replaces the manual process of RDP'ing to each server, copying patch files, running installers, and tracking which systems need which updates. Perfect for monthly patching cycles, emergency security updates, or bringing development environments up to production patch levels.</p>
<p>The impact of this function is set to High. Use -Confirm:$false to suppress interactive prompts for automated deployments.</p>
<p>For CredSSP authentication, the function automatically configures PowerShell remoting when credentials are provided. This can be disabled by setting dbatools configuration 'commands.initialize-credssp.bypass' to $true. CredSSP configuration requires running from an elevated PowerShell session.</p>
<p>Always backup databases and configurations before applying any SQL Server updates.</p>
<h2 id="syntax">Syntax</h2>
<pre><code>Update-DbaInstance
    [[-ComputerName] &lt;DbaInstanceParameter[]&gt;]
    [-Credential &lt;PSCredential&gt;]
    [-Version &lt;String[]&gt;]
    [-Type &lt;String[]&gt;]
    [-InstanceName &lt;String&gt;]
    [-Path &lt;String[]&gt;]
    [-Restart]
    [-Continue]
    [-Throttle &lt;Int32&gt;]
    [-Authentication &lt;String&gt;]
    [-ExtractPath &lt;String&gt;]
    [-ArgumentList &lt;String[]&gt;]
    [-Download]
    [-NoPendingRenameCheck]
    [-EnableException]
    [-WhatIf]
    [-Confirm]
    [&lt;CommonParameters&gt;]

Update-DbaInstance
    [[-ComputerName] &lt;DbaInstanceParameter[]&gt;]
    [-Credential &lt;PSCredential&gt;]
    -KB &lt;String[]&gt;
    [-InstanceName &lt;String&gt;]
    [-Path &lt;String[]&gt;]
    [-Restart]
    [-Continue]
    [-Throttle &lt;Int32&gt;]
    [-Authentication &lt;String&gt;]
    [-ExtractPath &lt;String&gt;]
    [-ArgumentList &lt;String[]&gt;]
    [-Download]
    [-NoPendingRenameCheck]
    [-EnableException]
    [-WhatIf]
    [-Confirm]
    [&lt;CommonParameters&gt;]

</code></pre>
<p> </p>
<h2 id="examples">Examples</h2>
<p> </p>
<h5 id="example-1">Example:  1</h5>
<pre><code>PS C:\&gt; Update-DbaInstance -ComputerName SQL1 -Version SP3 -Path \\network\share
</code></pre>
<p>Updates all applicable SQL Server installations on SQL1 to SP3.<br>
Binary files for the update will be searched among all files and folders recursively in \network\share.<br>
Prompts for confirmation before the update.<br></p>
<h5 id="example-2">Example:  2</h5>
<pre><code>PS C:\&gt; Update-DbaInstance -ComputerName SQL1, SQL2 -Restart -Path \\network\share -Confirm:$false
</code></pre>
<p>Updates all applicable SQL Server installations on SQL1 and SQL2 with the most recent patch (that has at least a &quot;CU&quot; flag).<br>
It will install latest ServicePack, restart the computers, install latest Cumulative Update, and finally restart the computer once again.<br>
Binary files for the update will be searched among all files and folders recursively in \network\share.<br>
Does not prompt for confirmation.<br></p>
<h5 id="example-3">Example:  3</h5>
<pre><code>PS C:\&gt; Update-DbaInstance -ComputerName SQL1 -Version 2012 -Type ServicePack -Path \\network\share
</code></pre>
<p>Updates SQL Server 2012 on SQL1 with the most recent ServicePack found in your patch repository.<br>
Binary files for the update will be searched among all files and folders recursively in \network\share.<br>
Prompts for confirmation before the update.<br></p>
<h5 id="example-4">Example:  4</h5>
<pre><code>PS C:\&gt; Update-DbaInstance -ComputerName SQL1 -KB 123456 -Restart -Path \\network\share -Confirm:$false
</code></pre>
<p>Installs KB 123456 on SQL1 and restarts the computer.<br>
Binary files for the update will be searched among all files and folders recursively in \network\share.<br>
Does not prompt for confirmation.<br></p>
<h5 id="example-5">Example:  5</h5>
<pre><code>PS C:\&gt; Update-DbaInstance -ComputerName Server1 -Version SQL2012SP3, SQL2016SP2CU3 -Path \\network\share -Restart -Confirm:$false
</code></pre>
<p>Updates SQL 2012 to SP3 and SQL 2016 to SP2CU3 on Server1. Each update will be followed by a restart.<br>
Binary files for the update will be searched among all files and folders recursively in \network\share.<br>
Does not prompt for confirmation.<br></p>
<h5 id="example-6">Example:  6</h5>
<pre><code>PS C:\&gt; Update-DbaInstance -ComputerName Server1 -Path \\network\share -Restart -Confirm:$false -ExtractPath &quot;C:\temp&quot;
</code></pre>
<p>Updates all applicable SQL Server installations on Server1 with the most recent patch. Each update will be followed by a restart.<br>
Binary files for the update will be searched among all files and folders recursively in \network\share.<br>
Does not prompt for confirmation.<br>
Extracts the files in local driver on Server1 C:\temp.<br></p>
<h5 id="example-7">Example:  7</h5>
<pre><code>PS C:\&gt; Update-DbaInstance -ComputerName Server1 -Path \\network\share -ArgumentList &quot;/SkipRules=RebootRequiredCheck&quot;
</code></pre>
<p>Updates all applicable SQL Server installations on Server1 with the most recent patch.<br>
Additional command line parameters would be passed to the executable.<br>
Binary files for the update will be searched among all files and folders recursively in \network\share.<br></p>
<h5 id="example-8">Example:  8</h5>
<pre><code>PS C:\&gt; Update-DbaInstance -ComputerName SQL1 -Version CU3 -Download -Path \\network\share -Confirm:$false
</code></pre>
<p>Downloads an appropriate CU KB to \network\share and installs it onto SQL1.<br>
Does not prompt for confirmation.<br></p>
<h3 id="required-parameters">Required Parameters</h3>
<h5 id="kb">-KB</h5>
<p>Installs a specific Knowledge Base update or list of updates by KB number.<br />
Use this when you need to apply a particular security patch or bug fix identified by Microsoft.<br />
Accepts formats like 123456 or KB123456, and supports multiple KB numbers for batch installations. <br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>True</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="optional-parameters">Optional Parameters</h3>
<h5 id="computername">-ComputerName</h5>
<p>Target computer with SQL instance or instances.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td>cn,host,Server</td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>true (ByValue)</td>
</tr>
<tr>
<td>Default Value</td>
<td>$env:COMPUTERNAME</td>
</tr>
</tbody>
</table>
<h5 id="credential">-Credential</h5>
<p>Windows Credential with permission to log on to the remote server.<br />
Must be specified for any remote connection if update Repository is located on a network folder.<br />
Authentication will default to CredSSP if -Credential is used.<br />
For CredSSP see also additional information in DESCRIPTION.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="version">-Version</h5>
<p>Defines the target SQL Server version level to reach using pattern <MajorVersion><SPX><CUX>.<br />
Use this to standardize SQL Server instances to a specific patch level across your environment.<br />
Examples: 2008R2SP1 (SQL 2008R2 to SP1), 2016CU3 (SQL 2016 to CU3), SP1CU7 (all versions to SP1 then CU7).<br />
When omitted, installs the latest available patches for each detected SQL Server version.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="type">-Type</h5>
<p>Specifies which types of SQL Server updates to install: All, ServicePack, or CumulativeUpdate.<br />
Use this when you want to apply only specific update types, such as installing only Service Packs during maintenance windows.<br />
Defaults to All, which installs both Service Packs and Cumulative Updates in proper sequence.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>@('All')</td>
</tr>
<tr>
<td>Accepted Values</td>
<td>All,ServicePack,CumulativeUpdate</td>
</tr>
</tbody>
</table>
<h5 id="instancename">-InstanceName</h5>
<p>Limits patching to a specific named SQL Server instance on the target computer.<br />
Use this when you have multiple SQL instances and need to patch only one, such as updating a development instance while leaving production untouched.<br />
Omit this parameter to update all SQL Server instances found on the target computers.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td>Instance</td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="path">-Path</h5>
<p>Specifies the folder path containing SQL Server update files for installation.<br />
Use this to point to your centralized patch repository where you store downloaded SQL Server updates.<br />
Files must follow Microsoft's naming pattern (SQLServer####<em>-KB###-</em>x##*.exe) and path must be accessible from both client and target servers.<br />
Configure a default path with Set-DbatoolsConfig -Name Path.SQLServerUpdates to avoid specifying this repeatedly.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>(Get-DbatoolsConfigValue -Name 'Path.SQLServerUpdates')</td>
</tr>
</tbody>
</table>
<h5 id="restart">-Restart</h5>
<p>Automatically restarts the server after successful patch installation and waits for it to come back online.<br />
Required for chaining multiple updates since SQL Server patches mandate a restart between installations.<br />
Use this during planned maintenance windows when you can afford server downtime for complete patch sequences.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>False</td>
</tr>
</tbody>
</table>
<h5 id="continue">-Continue</h5>
<p>Resumes a previously failed SQL Server update installation from where it left off.<br />
Use this when a patch installation was interrupted due to network issues, timeouts, or other temporary failures.<br />
Without this switch, the function will abort and clean up any failed installation attempts.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>False</td>
</tr>
</tbody>
</table>
<h5 id="throttle">-Throttle</h5>
<p>Controls the maximum number of servers that can be updated simultaneously during parallel operations.<br />
Use a lower value (5-10) for large production environments to limit network load and system resource usage.<br />
Defaults to 50, but consider your network bandwidth and the number of concurrent patch installations your infrastructure can handle.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>50</td>
</tr>
</tbody>
</table>
<h5 id="authentication">-Authentication</h5>
<p>Specifies the PowerShell remoting authentication method for connecting to remote SQL Server hosts.<br />
Defaults to CredSSP when using -Credential to avoid double-hop authentication issues with network patch repositories.<br />
Use CredSSP when your patch files are stored on network shares that require credential delegation to remote servers.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>@('Credssp', 'Default')[$null -eq $Credential]</td>
</tr>
<tr>
<td>Accepted Values</td>
<td>Default,Basic,Negotiate,NegotiateWithImplicitCredential,Credssp,Digest,Kerberos</td>
</tr>
</tbody>
</table>
<h5 id="extractpath">-ExtractPath</h5>
<p>Specifies the directory on target servers where SQL Server patch files will be extracted before installation.<br />
Use this to control where temporary installation files are placed, especially on servers with limited C: drive space.<br />
Defaults to system temporary directory if not specified, but consider using a dedicated drive with sufficient space.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="argumentlist">-ArgumentList</h5>
<p>Passes additional command-line parameters to the SQL Server patch installer executable.<br />
Use this to customize installation behavior such as skipping specific validation rules or running in quiet mode.<br />
Common examples include /SkipRules=RebootRequiredCheck to bypass reboot checks, or /Q for silent installation.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="download">-Download</h5>
<p>Automatically downloads missing SQL Server update files from Microsoft when they're not found in your patch repository.<br />
Use this to ensure patches are available during installation without manually downloading them beforehand.<br />
Files download to your local temp folder first, then get distributed to target servers or directly to network paths.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>False</td>
</tr>
</tbody>
</table>
<h5 id="nopendingrenamecheck">-NoPendingRenameCheck</h5>
<p>Bypasses the check for pending file rename operations that typically require a reboot before patching.<br />
Use this in environments where you're confident no pending renames exist or when system monitoring tools show false positives.<br />
Exercise caution as installing patches with pending renames can lead to installation failures.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>(Get-DbatoolsConfigValue -Name 'OS.PendingRename' -Fallback $false)</td>
</tr>
</tbody>
</table>
<h5 id="enableexception">-EnableException</h5>
<p>By default, when something goes wrong we try to catch it, interpret it and give you a friendly warning message.<br />
This avoids overwhelming you with &quot;sea of red&quot; exceptions, but is inconvenient because it basically disables advanced scripting.<br />
Using this switch turns this &quot;nice by default&quot; feature off and enables you to catch exceptions with your own try/catch.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td></td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td>False</td>
</tr>
</tbody>
</table>
<h5 id="whatif">-WhatIf</h5>
<p>Shows what would happen if the command were to run. No actions are actually performed.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td>wi</td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="confirm">-Confirm</h5>
<p>Prompts you for confirmation before executing any changing operations within the command.<br></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alias</td>
<td>cf</td>
</tr>
<tr>
<td>Required</td>
<td>False</td>
</tr>
<tr>
<td>Pipeline</td>
<td>false</td>
</tr>
<tr>
<td>Default Value</td>
<td></td>
</tr>
</tbody>
</table>
<p> </p>

                </div> <!-- rendered -->
            </div>
        </div>
    </div>
</body>

</html>
